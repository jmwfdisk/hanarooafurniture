<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="í•˜ë‚˜ë¡œì˜¤ì—ì´í¼ë‹ˆì²˜ - ì„ì§ì› ê²Œì‹œíŒ">
    <meta name="keywords" content="í•˜ë‚˜ë¡œì˜¤ì—ì´í¼ë‹ˆì²˜, ì„ì§ì›, ê²Œì‹œíŒ">
    <title>í•˜ë‚˜ë¡œì˜¤ì—ì´í¼ë‹ˆì²˜ ì„ì§ì›</title>
    
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    
    <!-- ê³µí†µ ì¸ì¦ CSS -->
    <link rel="stylesheet" href="../css/auth.css">
    <!-- ê³µí†µ ë””ìì¸ ì‹œìŠ¤í…œ CSS -->
    <link rel="stylesheet" href="../css/common.css">
    
    <style>
        /* ëª¨ë“  ë²„íŠ¼ì— ì†ê°€ë½ ì»¤ì„œ ì ìš© */
        button {
            cursor: pointer;
        }

        button:disabled {
            cursor: not-allowed;
        }

        body {
            margin: 0;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            background-color: #f5f5f7;
            color: #000000;
        }

        .navbar {
            background-color: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            padding: 5px 5px;
            display: flex;
            justify-content: flex-start;
            align-items: center;
            position: relative;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
            z-index: 1000;
            height: 78px;
            transition: all 0.3s ease;
        }

        .navbar > .logo {
            margin-right: auto;
        }
        
        .navbar .logo a {
            display: flex;
            align-items: center;
            gap: 10px;
            text-decoration: none;
            color: #000;
        }
        
        .navbar .logo img {
            height: 75px;
        }
        
        .navbar .logo a {
            pointer-events: none;
            cursor: default;
        }

        .navbar .logo span {
            font-size: 18px;
            font-weight: bold;
            white-space: nowrap;
        }

        .navbar > div {
            position: relative;
        }

        .navbar > div > a {
            margin: 13px 4px !important;
            font-size: 18px !important;
            font-weight: 600;
            letter-spacing: -0.5px;
            text-decoration: none;
            color: #212529;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            text-align: center;
            white-space: nowrap;
            position: relative;
            padding: 8px 12px;
            border-radius: 8px;
        }

        .navbar > div > a:hover {
            color: #44aa6b;
            background: rgba(68, 170, 107, 0.08);
        }

        .secondary-navbar {
            background: linear-gradient(135deg, #44aa6b 0%, #3a8f5a 100%);
            padding: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            box-shadow: 0 2px 8px rgba(68, 170, 107, 0.3);
            position: relative;
        }

        /* ëª¨ë°”ì¼ ë„êµ¬ ì•„ì´ì½˜ - ê¸°ë³¸ì ìœ¼ë¡œ ìˆ¨ê¹€ */
        .mobile-tool-icons {
            display: none;
            position: fixed;
            right: 10px;
            top: 130px;
            flex-direction: column;
            gap: 8px;
            z-index: 100;
        }

        .mobile-tool-btn {
            width: 48px;
            height: 48px;
            border-radius: 50%;
            border: none;
            font-size: 22px;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .mobile-tool-btn:first-child {
            background: linear-gradient(135deg, #64c8ff 0%, #4a9fd4 100%);
        }

        .mobile-tool-btn:last-child {
            background: linear-gradient(135deg, #ff96c8 0%, #e080a8 100%);
        }

        .mobile-tool-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
        }

        .mobile-tool-btn:active {
            transform: scale(0.95);
        }

        .secondary-navbar a {
            margin: 0;
            padding: 16px 24px;
            font-size: 15px;
            font-weight: 600;
            text-decoration: none;
            color: #fff;
            transition: all 0.3s ease;
            border-bottom: 3px solid transparent;
            position: relative;
        }

        .secondary-navbar a:hover {
            background: rgba(255, 255, 255, 0.1);
            border-bottom-color: rgba(255, 255, 255, 0.5);
        }

        .secondary-navbar a.active {
            background: rgba(255, 255, 255, 0.15);
            border-bottom-color: #fff;
            font-weight: 700;
        }

        .login-container {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%);
            padding: 32px;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            text-align: center;
            z-index: 1001;
            min-width: 360px;
            max-width: 420px;
            max-height: 90vh;
            animation: scaleIn 0.3s ease;
            overflow-y: auto;
            animation: modalFadeIn 0.2s ease-out;
        }

        @keyframes modalFadeIn {
            from { opacity: 0; transform: translate(-50%, -48%) scale(0.98); }
            to { opacity: 1; transform: translate(-50%, -50%) scale(1); }
        }

        .auth-tabs {
            display: flex;
            margin-bottom: 24px;
            border-radius: 12px;
            background: #e9ecef;
            padding: 4px;
        }

        .auth-tab {
            flex: 1;
            padding: 12px 20px;
            border: none;
            background: transparent;
            cursor: pointer;
            font-size: 15px;
            font-weight: 600;
            color: #6c757d;
            border-radius: 10px;
            transition: all 0.3s ease;
        }

        .auth-tab.active {
            background: linear-gradient(135deg, #44aa6b 0%, #3a8f5a 100%);
            color: white;
            box-shadow: 0 2px 8px rgba(68, 170, 107, 0.3);
        }

        .auth-tab:hover:not(.active) {
            color: #44aa6b;
        }

        .auth-form {
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes scaleIn {
            from { opacity: 0; transform: translate(-50%, -50%) scale(0.9); }
            to { opacity: 1; transform: translate(-50%, -50%) scale(1); }
        }

        .login-container h2 {
            margin: 0 0 24px 0;
            font-size: 24px;
            background: linear-gradient(135deg, #44aa6b 0%, #3a8f5a 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .login-container input {
            margin: 8px 0;
            padding: 12px 16px;
            width: calc(100% - 32px);
            border: 2px solid #e9ecef;
            border-radius: 12px;
            font-size: 14px;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            background: #fff;
        }

        .login-container input:focus {
            outline: none;
            border-color: #44aa6b;
            box-shadow: 0 0 0 4px rgba(68, 170, 107, 0.1);
            transform: translateY(-1px);
        }

        .login-container button:not(.auth-tab) {
            padding: 12px 24px;
            background: linear-gradient(135deg, #44aa6b 0%, #3a8f5a 100%);
            color: white;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            font-weight: 600;
            font-size: 15px;
            margin-top: 16px;
            width: 100%;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 4px 12px rgba(68, 170, 107, 0.3);
            position: relative;
            overflow: hidden;
        }

        .login-container button:not(.auth-tab)::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.2);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }

        .login-container button:not(.auth-tab):hover::before {
            width: 300px;
            height: 300px;
        }

        .login-container button:not(.auth-tab):hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(68, 170, 107, 0.4);
        }

        .auth-notice {
            margin-top: 16px;
            font-size: 12px;
            color: #6c757d;
            line-height: 1.5;
        }

        .overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(4px);
            z-index: 1000;
        }

        .footer-top {
            display: flex;
            justify-content: flex-end;
            align-items: flex-end;
            background-color: #ffffff;
            padding: 5px;
            font-size: 12px;
            gap: 10px;
        }

        .footer-top button:disabled {
            background-color: #ccc;
            color: #666;
            cursor: not-allowed;
        }

        .footer-top button {
            background-color: #ffffff;
            color: #7a7878;
            border: none;
            cursor: pointer;
            font-size: 12px;
            padding: 5px 5px;
            border-radius: 4px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s, box-shadow 0.3s;
        }

        .footer-top button:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 6px 10px rgba(0, 0, 0, 0.2);
        }

        .partner-logos {
            display: flex;
            justify-content: center;
            align-items: center;
            flex-wrap: wrap;
            gap: 20px;
            padding: 30px 20px;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-top: 1px solid rgba(0, 0, 0, 0.05);
            border-bottom: 1px solid rgba(0, 0, 0, 0.05);
        }

        .partner-logos a {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 40px;
            height: 40px;
            min-width: 40px;
            background: #ffffff;
            border-radius: 12px;
            padding: 6px;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
            position: relative;
            overflow: hidden;
            flex-shrink: 0;
        }
        
        .partner-logos a::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, rgba(0, 113, 227, 0.05) 0%, rgba(0, 91, 181, 0.05) 100%);
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .partner-logos a:hover {
            transform: translateY(-2px) scale(1.1);
            box-shadow: 0 4px 16px rgba(0, 113, 227, 0.2);
        }
        
        .partner-logos a:hover::before {
            opacity: 1;
        }

        .partner-logos img {
            width: 100%;
            height: 100%;
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
            border-radius: 6px;
            transition: all 0.3s ease;
            position: relative;
            z-index: 1;
        }
        
        .partner-logos a:hover img {
            transform: scale(1.2);
        }

        .board-section {
            max-width: 1000px;
            margin: 40px auto;
            background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%);
            border-radius: 24px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.08), 0 2px 8px rgba(0,0,0,0.04);
            padding: 40px 50px;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            border: 1px solid rgba(0,0,0,0.05);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            animation: fadeIn 0.8s ease;
            position: relative;
            overflow: hidden;
        }
        
        .board-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(68, 170, 107, 0.05), transparent);
            transition: left 0.5s ease;
        }
        
        .board-section:hover::before {
            left: 100%;
        }
        
        .board-section:hover {
            box-shadow: 0 16px 48px rgba(0,0,0,0.15), 0 8px 16px rgba(0,0,0,0.08);
            transform: translateY(-4px);
        }

.board-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid #e9ecef;
}

.board-header h2 {
            font-size: 28px;
            font-weight: 700;
            background: linear-gradient(135deg, #44aa6b 0%, #3a8f5a 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin: 0;
            letter-spacing: -0.5px;
            animation: slideUp 0.6s ease;
}

        .board-table {
            border-top: 2px solid #e9ecef;
            border-bottom: 1px solid #e9ecef;
            padding: 25px 0;
            background: #fff;
            border-radius: 12px;
            margin-top: 20px;
        }

        .table-header {
            display: grid;
            grid-template-columns: 60px 1fr 120px 120px;
            font-weight: 700;
            border-bottom: 2px solid #e9ecef;
            padding: 15px 20px;
            margin-bottom: 10px;
            background: linear-gradient(135deg, #f8f9fa 0%, #ffffff 100%);
            border-radius: 8px 8px 0 0;
            color: #495057;
            font-size: 14px;
            letter-spacing: 0.3px;
            gap: 10px;
        }

        .table-header span {
            text-align: center;
        }

        .table-header span:first-child {
            text-align: center;
        }

        .table-header span:nth-child(2) {
            text-align: center;
        }

        .table-body {
            min-height: 200px;
        }

        .table-empty {
            text-align: center;
            padding: 60px 20px;
            font-weight: 500;
            color: #6c757d;
            font-size: 16px;
            background: linear-gradient(135deg, #f8f9fa 0%, #ffffff 100%);
            border-radius: 12px;
            margin: 20px;
            border: 2px dashed #dee2e6;
            position: relative;
        }

        .table-empty::before {
            content: "ğŸ“‹";
            font-size: 48px;
            display: block;
            margin-bottom: 16px;
            opacity: 0.5;
        }

        .table-row {
            display: grid;
            grid-template-columns: 60px 1fr 120px 120px;
            font-size: 14px;
            padding: 16px 20px;
            align-items: center;
            border-bottom: 1px solid #f1f3f5;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            border-radius: 8px;
            margin: 4px 0;
            animation: fadeIn 0.4s ease;
            gap: 10px;
        }

        .table-row:hover {
            background: linear-gradient(135deg, #f8f9fa 0%, #ffffff 100%);
            transform: translateX(4px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
        }

        .table-row span {
            padding: 0 8px;
            color: #495057;
        }

        .table-row span:first-child {
            text-align: center;
        }

        .table-row span:nth-child(2) {
            text-align: center;
        }

        .table-row span:nth-child(3),
        .table-row span:nth-child(4) {
            text-align: center;
        }

        .table-row span:nth-child(2) a {
            display: inline-block;
            text-align: center;
        }

        .table-row button {
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a6f 100%);
            color: white;
            border: none;
            border-radius: 6px;
            padding: 4px 8px;
  cursor: pointer;
            font-size: 11px;
            font-weight: 600;
            transition: all 0.2s ease;
            box-shadow: 0 1px 3px rgba(255, 107, 107, 0.3);
            min-width: 45px;
            height: 24px;
            line-height: 1;
        }

        .table-row button:hover {
            background: linear-gradient(135deg, #ee5a6f 0%, #dc4a5f 100%);
            transform: translateY(-1px);
            box-shadow: 0 2px 6px rgba(255, 107, 107, 0.4);
        }

        .table-row button:active {
            transform: translateY(0);
        }

        .table-row a {
            text-decoration: none;
  color: #44aa6b;
            font-weight: 500;
            transition: all 0.2s ease;
            display: inline-block;
        }

        .table-row a:hover {
            color: #3a8f5a;
            text-decoration: underline;
            transform: translateX(2px);
        }

        .board-notice {
  font-size: 14px;
            color: #6c757d;
            margin-top: 30px;
            line-height: 1.8;
            padding: 20px 24px;
            background: linear-gradient(135deg, #e7f5ff 0%, #f0f9ff 100%);
            border-radius: 12px;
            border-left: 4px solid #44aa6b;
            box-shadow: 0 2px 8px rgba(68, 170, 107, 0.1);
            transition: all 0.3s ease;
        }

        .board-notice:hover {
            box-shadow: 0 4px 12px rgba(68, 170, 107, 0.15);
            transform: translateX(4px);
}

.pagination {
  text-align: center;
            margin: 30px 0;
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 8px;
            flex-wrap: nowrap;
        }

        .pagination-dot {
            margin: 0 3px;
            cursor: pointer;
            font-size: 12px;
            color: #adb5bd;
            outline: none;
            transition: all 0.2s ease;
            padding: 0;
            border-radius: 50%;
            width: 18px;
            height: 18px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            line-height: 1;
            vertical-align: middle;
            text-align: center;
        }

        .pagination-dot:hover {
            background-color: #e9ecef;
            color: #495057;
            transform: scale(1.03);
        }

        .pagination-dot.active {
            color: white;
            background: linear-gradient(135deg, #44aa6b 0%, #3a8f5a 100%);
            box-shadow: 0 1px 4px rgba(68, 170, 107, 0.3);
            transform: scale(1.05);
            display: inline-flex;
            align-items: center;
            justify-content: center;
            vertical-align: middle;
        }

        .pagination button {
            margin: 0 5px;
            padding: 8px 16px;
            border: 2px solid #e9ecef;
            background: #fff;
            border-radius: 8px;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            color: #495057;
            transition: all 0.2s ease;
        }

        .pagination button:hover:not(:disabled) {
            border-color: #44aa6b;
            color: #44aa6b;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(68, 170, 107, 0.2);
        }

        .pagination button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
}

.board-footer {
  display: flex;
  justify-content: space-between;
  align-items: center;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 2px solid #e9ecef;
            flex-wrap: wrap;
            gap: 16px;
}

.search-group {
  display: flex;
  gap: 8px;
            align-items: center;
            flex-wrap: wrap;
        }

        .search-group select {
            padding: 10px 14px;
            border: 2px solid #e9ecef;
            border-radius: 12px;
            background: #fff;
    font-size: 14px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .search-group select:focus {
            outline: none;
            border-color: #44aa6b;
            box-shadow: 0 0 0 4px rgba(68, 170, 107, 0.1);
}

.search-group input {
            padding: 10px 16px;
            border: 2px solid #e9ecef;
            border-radius: 12px;
            width: 250px;
    font-size: 14px;
            transition: all 0.3s ease;
        }

        .search-group input:focus {
            outline: none;
            border-color: #44aa6b;
            box-shadow: 0 0 0 4px rgba(68, 170, 107, 0.1);
}

.search-group button {
            padding: 10px 20px;
            background: linear-gradient(135deg, #44aa6b 0%, #3a8f5a 100%);
            color: #fff;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 4px 12px rgba(68, 170, 107, 0.3);
            position: relative;
            overflow: hidden;
        }

        .search-group button::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.2);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }

        .search-group button:hover::before {
            width: 300px;
            height: 300px;
        }

        .search-group button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(68, 170, 107, 0.4);
        }

        .action-buttons {
            display: flex;
            gap: 10px;
}

.action-buttons button {
            padding: 10px 20px;
            border: 2px solid #e9ecef;
            background: #fff;
            border-radius: 12px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            color: #495057;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .action-buttons button:hover {
            border-color: #44aa6b;
            color: #44aa6b;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(68, 170, 107, 0.2);
        }

.action-buttons .write {
            background: linear-gradient(135deg, #44aa6b 0%, #3a8f5a 100%);
            color: #fff;
            border: none;
            box-shadow: 0 4px 12px rgba(68, 170, 107, 0.3);
            position: relative;
            overflow: hidden;
        }

        .action-buttons .write::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.2);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }

        .action-buttons .write:hover::before {
            width: 300px;
            height: 300px;
        }

        .action-buttons .write:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(68, 170, 107, 0.4);
            color: #fff;
        }


        .write-form {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            max-width: 800px;
            width: 90%;
            padding: 32px;
            background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%);
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            z-index: 1001;
            animation: modalFadeIn 0.2s ease-out;
            max-height: 85vh;
            overflow-y: auto;
        }
        
        @keyframes modalFadeIn {
            from {
                opacity: 0;
                transform: translate(-50%, -48%) scale(0.98);
            }
            to {
                opacity: 1;
                transform: translate(-50%, -50%) scale(1);
            }
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .write-form h2 {
            margin: 0 0 24px 0;
            font-size: 24px;
            background: linear-gradient(135deg, #44aa6b 0%, #3a8f5a 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .write-form input,
        .write-form textarea {
            width: calc(100% - 32px);
            padding: 14px 16px;
            margin-bottom: 16px;
            border: 2px solid #e9ecef;
            border-radius: 12px;
            font-size: 15px;
            font-family: inherit;
            transition: all 0.3s ease;
        }

        .write-form input:focus,
        .write-form textarea:focus {
            outline: none;
            border-color: #44aa6b;
            box-shadow: 0 0 0 4px rgba(68, 170, 107, 0.1);
        }

        .write-form textarea {
            min-height: 200px;
            resize: vertical;
        }

        .write-form button {
            padding: 12px 24px;
            background: linear-gradient(135deg, #44aa6b 0%, #3a8f5a 100%);
            color: #fff;
            position: relative;
            overflow: hidden;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            font-size: 15px;
            font-weight: 600;
            margin-right: 10px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 12px rgba(68, 170, 107, 0.3);
        }

        .write-form button::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.2);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }

        .write-form button:hover::before {
            width: 300px;
            height: 300px;
        }

        .write-form button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(68, 170, 107, 0.4);
        }

        .write-form .cancel-btn {
            background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%);
            color: #495057;
            border: 2px solid #e9ecef;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }

        .write-form .cancel-btn:hover {
            border-color: #dee2e6;
            transform: translateY(-2px);
        }

        .post-modal {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%);
            border-radius: 20px;
            padding: 32px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            z-index: 1001;
            max-width: 700px;
            width: 90%;
            max-height: 85vh;
            overflow-y: auto;
            animation: modalFadeIn 0.2s ease-out;
        }

        @keyframes modalFadeIn {
            from {
                opacity: 0;
                transform: translate(-50%, -48%) scale(0.98);
            }
            to {
                opacity: 1;
                transform: translate(-50%, -50%) scale(1);
            }
        }

        .post-modal h3 {
            margin: 0 0 20px 0;
            font-size: 24px;
            background: linear-gradient(135deg, #44aa6b 0%, #3a8f5a 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .post-modal .post-meta {
            padding: 12px 16px;
            background: linear-gradient(135deg, #e7f5ff 0%, #f0f9ff 100%);
            border-radius: 8px;
            margin-bottom: 20px;
            border-left: 4px solid #44aa6b;
    font-size: 14px;
            color: #495057;
        }

        .post-modal .post-content {
            white-space: pre-wrap;
            line-height: 1.8;
            font-size: 15px;
            color: #495057;
            background: #fff;
            padding: 20px;
            border-radius: 12px;
            border: 1px solid #e9ecef;
            margin-bottom: 20px;
        }

        .post-modal .close-btn {
            position: absolute;
            top: 16px;
            right: 16px;
            background: none;
            border: none;
            font-size: 24px;
            color: #6c757d;
            cursor: pointer;
            padding: 4px 8px;
            border-radius: 8px;
            transition: all 0.2s ease;
        }

        .post-modal .close-btn:hover {
            background: #f1f3f5;
            color: #495057;
            transform: rotate(90deg);
        }

        .post-modal-actions {
            display: flex;
            justify-content: flex-end;
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid #e9ecef;
        }

        .post-delete-btn {
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a6f 100%);
            color: white;
            border: none;
            border-radius: 8px;
            padding: 10px 20px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .post-delete-btn:hover {
            background: linear-gradient(135deg, #ee5a6f 0%, #dc4a5f 100%);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(255, 107, 107, 0.4);
        }

        .post-delete-btn:active {
            transform: translateY(0);
        }

        .login {
            display: flex;
            align-items: center;
            gap: 8px;
            flex-direction: row;
        }

        .employee-btn {
            display: flex;
            align-items: center;
        }
        
        .employee-btn button {
            padding: 6px 12px;
            font-size: 13px;
            font-weight: 600;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .employee-btn button:not(:disabled) {
            background: linear-gradient(135deg, #44aa6b 0%, #3a8f5a 100%);
            color: white;
            box-shadow: 0 2px 8px rgba(68, 170, 107, 0.3);
        }

        .employee-btn button:not(:disabled):hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(68, 170, 107, 0.4);
        }

        .employee-btn button:disabled {
            background-color: #e9ecef;
            color: #adb5bd;
            cursor: not-allowed;
        }

        /* ë¡œê·¸ì¸ ì•„ì´ì½˜ ìŠ¤íƒ€ì¼ */
        .login-icon {
            height: 20px;
            width: auto;
            margin-right: 5px;
            vertical-align: middle;
        }

        footer {
            background-color: #ccc8c8;
            color: #696868;
            padding: 20px;
            margin-top: 40px;
            text-align: center;
            padding-bottom: 15px;
        }

        footer p {
            font-size: 13px;
            margin: 8px 0;
            line-height: 1.5;
        }

        footer p1 {
            font-size: 13px;
            text-align: left;
        }

        footer::before {
            content: "";
            display: block;
            width: 68%;
            margin: 0 auto;
            border-top: 1px solid #ccc;
            margin-bottom: 10px;
}

    @media (max-width: 1024px) {
        .navbar {
                display: grid;
                grid-template-columns: auto 1fr auto;
            align-items: center;
            height: 59px;
            padding: 0 8px;
        }

        .navbar .login a {
            margin: 0 !important;
        }

        .navbar .login {
                grid-column: 3;
            margin-left: auto;
            display: flex;
                flex-direction: row;
                gap: 8px;
            align-items: center;
        }
            
            .employee-btn {
                display: flex !important;
            }
            
            .employee-btn button {
                padding: 6px 12px;
                font-size: 12px;
            }

        .navbar > div:not(.logo):not(.login):not(.mobile-only) {
            display: none;
        }

            .employee-btn { 
                display: block;
                pointer-events: auto;
            }

            .employee-btn button:disabled {
                pointer-events: none !important;
                cursor: default;
            }

            .employee-btn:has(button:disabled) {
                pointer-events: none !important;
            }

        .footer-top { display: none; }
        .login-icon { display: none; }
            .navbar > .logo { 
                margin-right: 0;
            }

        .hamburger {
            grid-column: 1;
            display: inline-flex;
                width: 28px;
                height: 24px;
            position: relative;
            justify-self: start;
                padding: 0;
                border: 0;
                background: transparent;
                cursor: pointer;
                z-index: 1003 !important;
                align-items: center;
                justify-content: center;
                margin-right: auto;
        }

        .hamburger .bar {
            position: absolute; left: 0; right: 0;
            height: 2px; background: #000; margin: 0;
        }
        
        .hamburger .bar:nth-child(1) { top: 2px; }
        .hamburger .bar:nth-child(2) { top: 11px; }
        .hamburger .bar:nth-child(3) { bottom: 2px; }

        .navbar .logo {
            grid-column: 2;
            justify-self: start;
            align-self: center;
            position: static;
            transform: none;
            z-index: 1;
            margin-top: 0;
            margin-left: 12px;
        }

        .navbar .logo img {
            height: 55px;
        }

        .navbar .logo span {
            font-size: 14px !important;
            font-weight: bold;
        }

        .mobile-drawer {
            position: fixed;
            top: 59px;
            left: 0;
            width: 80%;
            max-width: 340px;
            height: calc(100vh - 59px);
            background: #fff;
            box-shadow: 2px 0 12px rgba(0,0,0,0.15);
            transform: translateX(-100%);
            transition: transform 0.3s ease;
            display: flex !important;
            flex-direction: column;
            padding: 16px 20px;
            gap: 8px;
            z-index: 1001;
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
        }

        .mobile-drawer a {
            padding: 12px 16px;
            border-bottom: 1px solid #eee;
            text-align: left;
            font-weight: 600;
            font-size: 16px;
            color: #212529;
            text-decoration: none;
            transition: all 0.3s ease;
            border-radius: 8px;
            margin: 2px 0;
        }
        
        .mobile-drawer a:hover {
            background: rgba(68, 170, 107, 0.1);
            color: #44aa6b;
            padding-left: 20px;
        }

        .mobile-drawer.open { transform: translateX(0); }

        .body.menu-open { overflow: hidden; }
        .overlay.menu-open { display: block !important; }

            .secondary-navbar {
                flex-wrap: wrap;
                padding: 0;
            }

            .secondary-navbar a {
                padding: 12px 16px;
                font-size: 13px;
                border-bottom: 3px solid transparent;
            }
            
            .secondary-navbar a:hover {
                background: rgba(255, 255, 255, 0.1);
                border-bottom-color: rgba(255, 255, 255, 0.5);
            }
            
            .secondary-navbar a.active {
                background: rgba(255, 255, 255, 0.15);
                border-bottom-color: #fff;
                font-weight: 700;
            }

            /* ëª¨ë°”ì¼ì—ì„œ ë°ìŠ¤í¬í†± ë„êµ¬ ë²„íŠ¼ ìˆ¨ê¹€ */
            .desktop-tool-btn {
                display: none !important;
            }

            /* ëª¨ë°”ì¼ ë„êµ¬ ì•„ì´ì½˜ í‘œì‹œ */
            .mobile-tool-icons {
                display: flex !important;
            }

            .board-section {
                margin: 20px auto;
                padding: 24px 16px;
                border-radius: 16px;
            }

            .board-header h2 {
                font-size: 20px;
            }

            .board-table {
                font-size: 12px;
                padding: 15px 0;
            }

            .table-header {
                grid-template-columns: 40px 1fr 80px 80px;
                gap: 8px;
                font-size: 11px;
                padding: 12px 8px;
            }

            .table-row {
                grid-template-columns: 40px 1fr 80px 80px !important;
                font-size: 12px !important;
                padding: 12px 8px !important;
                gap: 8px;
            }

            .table-row button {
                font-size: 10px !important;
                padding: 3px 6px !important;
                min-width: 40px !important;
                height: 22px !important;
            }

            .table-row span {
                font-size: 11px !important;
                padding: 0 4px !important;
            }

            .table-empty {
                padding: 40px 15px;
                font-size: 14px;
                margin: 10px;
            }

            .board-footer {
                flex-direction: column;
                align-items: stretch;
            }

            .search-group {
                width: 100%;
            }

            .search-group input {
                width: 100%;
                flex: 1;
            }

            .action-buttons {
                width: 100%;
                justify-content: space-between;
            }

            .action-buttons button {
                flex: 1;
            }

        footer { 
                padding: 14px 12px 18px;
        }

        footer::before{
                width: 90%;
            margin-bottom: 10px;
        }

        footer p, footer .footer-info{
                font-size: 10px;
                line-height: 1.35;
                letter-spacing: 0;
                text-align: left;
            margin: 4px 0;
        }

            .write-form {
                padding: 20px 16px;
            }

            .post-modal {
                padding: 24px;
                max-width: 95%;
            }
            
            .partner-logos {
                gap: 16px;
                padding: 25px 15px;
            }
            
            .partner-logos a {
                width: 35px;
                height: 35px;
                min-width: 35px;
                padding: 6px;
            }
            
            .partner-logos img {
                max-width: 100%;
                max-height: 100%;
            }
        }

        .hamburger { display: none; background: transparent; border: 0; padding: 8px; cursor: pointer; }
        .hamburger .bar { display: block; width: 22px; height: 2px; margin: 4px 0; background: #000; transition: transform 0.3s, opacity 0.3s; }
        .mobile-drawer { display: none !important; }
    </style>
</head>

    <body>
    <div class="overlay" id="overlay"></div>

    <div class="login-container" id="login-container">
        <!-- íƒ­ ë²„íŠ¼ -->
        <div class="auth-tabs">
            <button class="auth-tab active" onclick="showAuthTab('login')">ë¡œê·¸ì¸</button>
            <button class="auth-tab" onclick="showAuthTab('register')">íšŒì›ê°€ì…</button>
        </div>
        
        <!-- ë¡œê·¸ì¸ í¼ -->
        <div id="login-form" class="auth-form">
            <input type="text" id="username" placeholder="ì•„ì´ë”” ë˜ëŠ” ì´ë©”ì¼">
            <input type="password" id="password" placeholder="ë¹„ë°€ë²ˆí˜¸">
            <button type="button" onclick="login()">ë¡œê·¸ì¸</button>
        </div>
        
        <!-- íšŒì›ê°€ì… í¼ -->
        <div id="register-form" class="auth-form" style="display: none;">
            <input type="text" id="reg-username" placeholder="ì•„ì´ë”” (4ì ì´ìƒ)">
            <input type="password" id="reg-password" placeholder="ë¹„ë°€ë²ˆí˜¸ (6ì ì´ìƒ)">
            <input type="password" id="reg-password-confirm" placeholder="ë¹„ë°€ë²ˆí˜¸ í™•ì¸">
            <input type="text" id="reg-name" placeholder="ì´ë¦„">
            <input type="email" id="reg-email" placeholder="ì´ë©”ì¼">
            <input type="tel" id="reg-phone" placeholder="ì—°ë½ì²˜">
            <select id="reg-user-type" style="width: 100%; padding: 12px; margin: 8px 0; border: 1px solid #ddd; border-radius: 8px; font-size: 14px;">
                <option value="general">ì¼ë°˜íšŒì›</option>
                <option value="employee">ì„ì§ì›</option>
            </select>
            <button onclick="register()">íšŒì›ê°€ì… ì‹ ì²­</button>
            <p class="auth-notice">* íšŒì›ê°€ì… í›„ ê´€ë¦¬ì ìŠ¹ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.</p>
        </div>
    </div>

    <header class="navbar">
        <button class="hamburger" id="hamburger" aria-label="ë©”ë‰´ ì—´ê¸°" aria-controls="mobile-nav" aria-expanded="false">
            <span class="bar"></span>
            <span class="bar"></span>
            <span class="bar"></span>
        </button>

        <div class="logo">
            <img src="../image/logo-nav.png" alt="ë¡œê³ " style="height: 40px;">
        </div>

        <nav id="mobile-nav" class="mobile-drawer" role="navigation" aria-label="ëª¨ë°”ì¼ ë©”ë‰´">
            <a href="../../index.html">í™ˆ</a>
            <a href="../company/company.html">íšŒì‚¬ì†Œê°œ</a>
            <a href="../product/product.html">ì œí’ˆì†Œê°œ</a>
            <a href="../school/school.html">ë‚©í’ˆí•™êµ ë¦¬ìŠ¤íŠ¸</a>
            <a href="../Gallery/Gallery.html">ê°¤ëŸ¬ë¦¬</a>
            <a href="../AS/AS.html">A/Sì‹ ì²­</a>
        </nav>

        <div>
            <a href="../../index.html">í™ˆ</a>
        </div>

        <div>
            <a href="../company/company.html">íšŒì‚¬ì†Œê°œ</a>
        </div>
        
        <div>
            <a href="../product/product.html">ì œí’ˆì†Œê°œ</a>
        </div>

        <div>
            <a href="../school/school.html">ë‚©í’ˆí•™êµ ë¦¬ìŠ¤íŠ¸</a>
        </div>

        <div>
            <a href="../Gallery/Gallery.html">ê°¤ëŸ¬ë¦¬</a>
        </div>

        <div>
            <a href="../AS/AS.html">A/Sì‹ ì²­</a>
        </div>

        <div class="login">
            <a href="#" onclick="showLogin()" id="login-link" class="login-item">
                <img src="../image/login.png" alt="ë¡œê·¸ì¸" class="login-icon"> ë¡œê·¸ì¸
            </a>
            <a href="#" onclick="logout()" id="logout-link" class="login-item" style="display:none;">
                <img src="../image/logout.png" alt="ë¡œê·¸ì•„ì›ƒ" class="login-icon"> ë¡œê·¸ì•„ì›ƒ
            </a>
        </div>
    </header>

    <nav class="secondary-navbar">
        <a href="#" onclick="switchBoard('notice'); return false;" class="active" data-board="notice">ê³µì§€ì‚¬í•­</a>
        <a href="#" onclick="switchBoard('staff'); return false;" data-board="staff">ì§ì›ê²Œì‹œíŒ</a>
        <a href="#" onclick="switchBoard('suggestion'); return false;" data-board="suggestion">ì œì•ˆí™œë™</a>
        <a href="#" onclick="switchBoard('as-result'); return false;" data-board="as-result">A/S ì²˜ë¦¬ê²°ê³¼</a>
        <a href="#" onclick="switchBoard('photo-gallery'); return false;" data-board="photo-gallery">ğŸ“· í™œë™ì‚¬ì§„ì²©</a>
        <a href="#" onclick="switchBoard('member-management'); return false;" data-board="member-management" style="background: rgba(255,215,0,0.2);">ğŸ‘¥ íšŒì›ê´€ë¦¬</a>
        <a href="#" onclick="openCalculator(); return false;" class="desktop-tool-btn" style="background: rgba(100,200,255,0.2);">ğŸ§® ê³„ì‚°ê¸°</a>
        <a href="#" onclick="openDrawingBoard(); return false;" class="desktop-tool-btn" style="background: rgba(255,150,200,0.2);">ğŸ¨ ê·¸ë¦¼íŒ</a>
    </nav>

    <!-- ëª¨ë°”ì¼ìš© ë„êµ¬ ì•„ì´ì½˜ -->
    <div class="mobile-tool-icons">
        <button onclick="openCalculator()" class="mobile-tool-btn" title="ê³„ì‚°ê¸°">ğŸ§®</button>
        <button onclick="openDrawingBoard()" class="mobile-tool-btn" title="ê·¸ë¦¼íŒ">ğŸ¨</button>
    </div>

    <!-- ê³µí†µ ì¸ì¦ ìŠ¤í¬ë¦½íŠ¸ -->
    <script src="../js/auth.js"></script>

     <script>
        // Firebase Firestore ì°¸ì¡° (auth.jsì—ì„œ ì´ˆê¸°í™”ëœ ê²ƒ ì‚¬ìš©)
        let db = null;
        
        // auth.js ë¡œë“œ í›„ db ì„¤ì •
        function initStaffDB() {
            if (typeof authDb !== 'undefined' && authDb) {
                db = authDb;
            } else if (typeof firebase !== 'undefined' && firebase.apps.length > 0) {
                db = firebase.firestore();
            }
        }
        
        // ì¦‰ì‹œ ì‹œë„
        initStaffDB();

        let currentBoard = 'notice';
        let currentPage = {};
        let currentPostIndex = -1; // í˜„ì¬ ìƒì„¸ë³´ê¸° ì¤‘ì¸ ê²Œì‹œê¸€ ì¸ë±ìŠ¤
        const postsPerPage = 10;
        let allPosts = {
            notice: [],
            staff: [],
            suggestion: [],
            'as-result': []
        };

        // í˜ì´ì§€ ì´ˆê¸°í™”
        Object.keys(allPosts).forEach(board => {
            currentPage[board] = 1;
        });

        document.addEventListener("DOMContentLoaded", function() {
            // ìŠ¤íƒœí”„ í˜ì´ì§€ ì ‘ì† ê¶Œí•œ í™•ì¸ (ì„ì§ì›ë§Œ ì ‘ì† ê°€ëŠ¥)
            const loggedInUser = sessionStorage.getItem('loggedInUser');
            if (!loggedInUser) {
                alert('ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.');
                window.location.href = '../../index.html';
                return;
            }
            
            try {
                const userData = JSON.parse(loggedInUser);
                const isEmployee = userData.userType === 'employee' || userData.isAdmin;
                
                if (!isEmployee) {
                    alert('ì„ì§ì›ë§Œ ì ‘ì†í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.');
                    window.location.href = '../../index.html';
                    return;
                }
            } catch (e) {
                console.error('ì‚¬ìš©ì ì •ë³´ íŒŒì‹± ì˜¤ë¥˜:', e);
                alert('ì‚¬ìš©ì ì •ë³´ë¥¼ í™•ì¸í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                window.location.href = '../../index.html';
                return;
            }
            
            // DB ì´ˆê¸°í™” í™•ì¸
            if (!db) {
                initStaffDB();
            }
            
            // ê²Œì‹œê¸€ ë¡œë“œ
            loadAllPosts();
            switchBoard('notice');
            
            // ì‘ì„± ë²„íŠ¼ í‘œì‹œ ì—¬ë¶€ ì´ˆê¸°í™”
            updateWriteButtonVisibility();
        });

        // Firebase Firestoreì—ì„œ ê²Œì‹œê¸€ ë¡œë“œ
        async function loadAllPosts() {
            if (db) {
                // Firebase Firestore ì‚¬ìš©
                try {
                    for (const board of Object.keys(allPosts)) {
                        const snapshot = await db.collection('staffPosts').doc(board).get();
                        if (snapshot.exists) {
                            allPosts[board] = snapshot.data().posts || [];
                        } else {
                            // ê¸°ì¡´ localStorage ë°ì´í„° ë§ˆì´ê·¸ë ˆì´ì…˜
                            const stored = localStorage.getItem(`staffPosts_${board}`);
                            if (stored) {
                                allPosts[board] = JSON.parse(stored);
                                // Firebaseë¡œ ë§ˆì´ê·¸ë ˆì´ì…˜
                                await db.collection('staffPosts').doc(board).set({ posts: allPosts[board] });
                            }
                        }
                    }
                } catch (error) {
                    console.error('Firebase ë¡œë“œ ì‹¤íŒ¨:', error);
                    // ì‹¤íŒ¨ ì‹œ localStorage ì‚¬ìš©
                    loadFromLocalStorage();
                }
            } else {
                // localStorage ì‚¬ìš©
                loadFromLocalStorage();
            }
        }

        function loadFromLocalStorage() {
            Object.keys(allPosts).forEach(board => {
                const stored = localStorage.getItem(`staffPosts_${board}`);
                if (stored) {
                    allPosts[board] = JSON.parse(stored);
                }
            });
        }

        // Firebase Firestoreì— ê²Œì‹œê¸€ ì €ì¥
        async function savePosts(board) {
            if (db) {
                // Firebase Firestore ì‚¬ìš©
                try {
                    await db.collection('staffPosts').doc(board).set({ posts: allPosts[board] });
                } catch (error) {
                    console.error('Firebase ì €ì¥ ì‹¤íŒ¨:', error);
                    // ì‹¤íŒ¨ ì‹œ localStorageì— ë°±ì—…
                    localStorage.setItem(`staffPosts_${board}`, JSON.stringify(allPosts[board]));
                }
            } else {
                // localStorage ì‚¬ìš©
                localStorage.setItem(`staffPosts_${board}`, JSON.stringify(allPosts[board]));
            }
        }

        function switchBoard(boardType) {
            currentBoard = boardType;
            
            // ë„¤ë¹„ê²Œì´ì…˜ í™œì„±í™”
            document.querySelectorAll('.secondary-navbar a').forEach(a => {
                a.classList.remove('active');
            });
            document.querySelector(`[data-board="${boardType}"]`).classList.add('active');

            // íšŒì›ê´€ë¦¬ íƒ­ ì²˜ë¦¬
            const boardSection = document.querySelector('.board-section:not(#member-section)');
            const memberSection = document.getElementById('member-section');
            
            // í™œë™ì‚¬ì§„ì²© ì„¹ì…˜ ì²˜ë¦¬
            const photoSection = document.getElementById('photo-gallery-section');
            
            if (boardType === 'member-management') {
                // ê´€ë¦¬ì ê¶Œí•œ í™•ì¸
                const loggedInUser = sessionStorage.getItem('loggedInUser');
                if (!loggedInUser) {
                    alert('ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.');
                    switchBoard('notice');
                    return;
                }
                const userData = JSON.parse(loggedInUser);
                if (!userData.isAdmin && userData.username !== 'admin') {
                    alert('ê´€ë¦¬ìë§Œ ì ‘ê·¼í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.');
                    switchBoard('notice');
                    return;
                }
                
                boardSection.style.display = 'none';
                memberSection.style.display = 'block';
                if (photoSection) photoSection.style.display = 'none';
                loadMembers();
                return;
            } else if (boardType === 'photo-gallery') {
                // ë¡œê·¸ì¸ í™•ì¸
                const loggedInUser = sessionStorage.getItem('loggedInUser');
                if (!loggedInUser) {
                    alert('ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.');
                    switchBoard('notice');
                    return;
                }
                
                boardSection.style.display = 'none';
                memberSection.style.display = 'none';
                if (photoSection) photoSection.style.display = 'block';
                loadPhotos();
                return;
            } else {
                boardSection.style.display = 'block';
                memberSection.style.display = 'none';
                if (photoSection) photoSection.style.display = 'none';
            }

            // ê²Œì‹œíŒ ì œëª© ë³€ê²½
            const titles = {
                'notice': 'ê³µì§€ì‚¬í•­',
                'staff': 'ì§ì›ê²Œì‹œíŒ',
                'suggestion': 'ì œì•ˆí™œë™',
                'as-result': 'A/S ì²˜ë¦¬ê²°ê³¼'
            };

            document.getElementById('board-title').textContent = titles[boardType];
            
            // ê³µì§€ì‚¬í•­ì¼ ë•Œ ì‘ì„± ë²„íŠ¼ í‘œì‹œ ì—¬ë¶€ ê²°ì •
            updateWriteButtonVisibility();
            
            // ê²Œì‹œê¸€ ë Œë”ë§
            renderPosts();
        }
        
        // ì‘ì„± ë²„íŠ¼ í‘œì‹œ ì—¬ë¶€ ì—…ë°ì´íŠ¸
        function updateWriteButtonVisibility() {
            const writeBtn = document.querySelector('.write');
            if (!writeBtn) return;
            
            // ê³µì§€ì‚¬í•­ì€ ê´€ë¦¬ìë§Œ ì‘ì„± ê°€ëŠ¥
            if (currentBoard === 'notice') {
                const loggedInUser = sessionStorage.getItem('loggedInUser');
                if (loggedInUser) {
                    try {
                        const userData = JSON.parse(loggedInUser);
                        const isAdmin = userData.isAdmin || userData.username === 'admin';
                        writeBtn.style.display = isAdmin ? 'block' : 'none';
                    } catch (e) {
                        console.error('ì‚¬ìš©ì ì •ë³´ íŒŒì‹± ì˜¤ë¥˜:', e);
                        writeBtn.style.display = 'none';
                    }
                } else {
                    writeBtn.style.display = 'none';
                }
            } else {
                // ë‹¤ë¥¸ ê²Œì‹œíŒì€ ëª¨ë‘ ì‘ì„± ê°€ëŠ¥
                writeBtn.style.display = 'block';
            }
        }

        function renderPosts() {
            const tbody = document.getElementById('board-tbody');
            const posts = allPosts[currentBoard];
            
            tbody.innerHTML = '';

            if (posts.length === 0) {
                tbody.innerHTML = '<div class="table-empty">ê²Œì‹œê¸€ì´ ì—†ìŠµë‹ˆë‹¤.</div>';
                renderPagination();
                return;
            }

            const start = (currentPage[currentBoard] - 1) * postsPerPage;
            const end = start + postsPerPage;
            const pagePosts = posts.slice(start, end);

            pagePosts.forEach((post, index) => {
                const row = document.createElement('div');
                row.className = 'table-row';
                const globalIndex = start + index;
                row.innerHTML = `
                    <span>${posts.length - globalIndex}</span>
                    <span><a href="#" onclick="viewPost(${globalIndex}); return false;">${post.title}</a></span>
                    <span>${post.author}</span>
                    <span>${post.date}</span>
                `;
                tbody.appendChild(row);
            });

            renderPagination();
        }

        function deletePost(index) {
            // í˜„ì¬ ì‚¬ìš©ì ì •ë³´ ê°€ì ¸ì˜¤ê¸°
            const loggedInUser = sessionStorage.getItem('loggedInUser');
            if (!loggedInUser) {
                alert('ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.');
                return;
            }
            
            const userData = JSON.parse(loggedInUser);
            const post = allPosts[currentBoard][index];
            const isAdmin = userData.isAdmin || userData.username === 'admin';
            
            // ì‚­ì œ ê¶Œí•œ ì²´í¬
            let canDelete = false;
            let errorMessage = '';
            
            if (currentBoard === 'notice') {
                // ê³µì§€ì‚¬í•­: ê´€ë¦¬ìë§Œ ì‚­ì œ ê°€ëŠ¥
                if (isAdmin) {
                    canDelete = true;
                } else {
                    errorMessage = 'ê³µì§€ì‚¬í•­ì€ ê´€ë¦¬ìë§Œ ì‚­ì œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.';
                }
            } else if (currentBoard === 'staff' || currentBoard === 'suggestion' || currentBoard === 'as-result') {
                // ì§ì›ê²Œì‹œíŒ, ì œì•ˆí™œë™, A/S ì²˜ë¦¬ê²°ê³¼: ì‘ì„±ì ë˜ëŠ” ê´€ë¦¬ìë§Œ ì‚­ì œ ê°€ëŠ¥
                const isAuthor = post.author === userData.name || 
                                post.author === userData.username ||
                                (post.uid && post.uid === userData.uid);
                
                if (isAdmin || isAuthor) {
                    canDelete = true;
                } else {
                    errorMessage = 'ì‘ì„±ì ë˜ëŠ” ê´€ë¦¬ìë§Œ ì‚­ì œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.';
                }
            } else {
                // ê¸°íƒ€ ê²Œì‹œíŒ: ê¸°ë³¸ì ìœ¼ë¡œ ì‘ì„±ì ë˜ëŠ” ê´€ë¦¬ìë§Œ ì‚­ì œ ê°€ëŠ¥
                const isAuthor = post.author === userData.name || 
                                post.author === userData.username ||
                                (post.uid && post.uid === userData.uid);
                
                if (isAdmin || isAuthor) {
                    canDelete = true;
                } else {
                    errorMessage = 'ì‘ì„±ì ë˜ëŠ” ê´€ë¦¬ìë§Œ ì‚­ì œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.';
                }
            }
            
            if (!canDelete) {
                alert(errorMessage);
                return;
            }
            
            if (confirm("ì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?")) {
                allPosts[currentBoard].splice(index, 1);
                savePosts(currentBoard).then(() => {
                    // í˜„ì¬ í˜ì´ì§€ê°€ ë¹„ì–´ìˆìœ¼ë©´ ì´ì „ í˜ì´ì§€ë¡œ ì´ë™
                    const totalPages = Math.ceil(allPosts[currentBoard].length / postsPerPage);
                    if (currentPage[currentBoard] > totalPages && totalPages > 0) {
                        currentPage[currentBoard] = totalPages;
                    }
                    renderPosts();
                });
            }
        }

        function renderPagination() {
            const pagination = document.getElementById('pagination');
            pagination.innerHTML = '';
            
            const totalPages = Math.ceil(allPosts[currentBoard].length / postsPerPage);
            if (totalPages === 0) return;

            const prevBtn = document.createElement('span');
            prevBtn.textContent = 'â—€';
            prevBtn.className = 'pagination-dot';
            prevBtn.style.cursor = currentPage[currentBoard] > 1 ? 'pointer' : 'not-allowed';
            prevBtn.style.opacity = currentPage[currentBoard] > 1 ? '1' : '0.5';
            prevBtn.style.fontSize = '12px';
            prevBtn.style.width = '18px';
            prevBtn.style.height = '18px';
            prevBtn.onclick = () => {
                if (currentPage[currentBoard] > 1) {
                    currentPage[currentBoard]--;
                    renderPosts();
                }
            };
            pagination.appendChild(prevBtn);

            for (let i = 1; i <= totalPages; i++) {
                const dot = document.createElement('span');
                dot.textContent = 'â—';
                dot.className = 'pagination-dot';
                if (i === currentPage[currentBoard]) {
                    dot.classList.add('active');
                }
                dot.onclick = () => {
                    currentPage[currentBoard] = i;
                    renderPosts();
                };
                pagination.appendChild(dot);
            }

            const nextBtn = document.createElement('span');
            nextBtn.textContent = 'â–¶';
            nextBtn.className = 'pagination-dot';
            nextBtn.style.cursor = currentPage[currentBoard] < totalPages ? 'pointer' : 'not-allowed';
            nextBtn.style.opacity = currentPage[currentBoard] < totalPages ? '1' : '0.5';
            nextBtn.style.fontSize = '12px';
            nextBtn.style.width = '18px';
            nextBtn.style.height = '18px';
            nextBtn.onclick = () => {
                if (currentPage[currentBoard] < totalPages) {
                    currentPage[currentBoard]++;
                    renderPosts();
                }
            };
            pagination.appendChild(nextBtn);
        }

        function showWriteForm() {
            // ê³µì§€ì‚¬í•­ì€ ê´€ë¦¬ìë§Œ ì‘ì„± ê°€ëŠ¥
            if (currentBoard === 'notice') {
                const loggedInUser = sessionStorage.getItem('loggedInUser');
                if (!loggedInUser) {
                    alert('ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.');
                    return;
                }
                
                try {
                    const userData = JSON.parse(loggedInUser);
                    const isAdmin = userData.isAdmin || userData.username === 'admin';
                    
                    if (!isAdmin) {
                        alert('ê³µì§€ì‚¬í•­ì€ ê´€ë¦¬ìë§Œ ì‘ì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.');
                        return;
                    }
                } catch (e) {
                    console.error('ì‚¬ìš©ì ì •ë³´ íŒŒì‹± ì˜¤ë¥˜:', e);
                    alert('ì‚¬ìš©ì ì •ë³´ë¥¼ í™•ì¸í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                    return;
                }
            }
            
            const writeForm = document.getElementById('write-form');
            const overlay = document.getElementById('overlay');
            
            if (!writeForm || !overlay) {
                console.error('write-form ë˜ëŠ” overlay ìš”ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }
            
            writeForm.style.display = 'block';
            overlay.style.display = 'block';
            
            const titleInput = document.getElementById('write-title');
            const authorInput = document.getElementById('write-author');
            const contentInput = document.getElementById('write-content');
            
            if (titleInput) titleInput.value = '';
            if (authorInput) authorInput.value = '';
            if (contentInput) contentInput.value = '';
        }

        function hideWriteForm() {
            const writeForm = document.getElementById('write-form');
            const overlay = document.getElementById('overlay');
            
            if (writeForm) writeForm.style.display = 'none';
            if (overlay) overlay.style.display = 'none';
        }

        function submitPost() {
            // ê³µì§€ì‚¬í•­ì€ ê´€ë¦¬ìë§Œ ì‘ì„± ê°€ëŠ¥
            if (currentBoard === 'notice') {
                const loggedInUser = sessionStorage.getItem('loggedInUser');
                if (!loggedInUser) {
                    alert('ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.');
                    return;
                }
                
                try {
                    const userData = JSON.parse(loggedInUser);
                    const isAdmin = userData.isAdmin || userData.username === 'admin';
                    
                    if (!isAdmin) {
                        alert('ê³µì§€ì‚¬í•­ì€ ê´€ë¦¬ìë§Œ ì‘ì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.');
                        return;
                    }
                } catch (e) {
                    console.error('ì‚¬ìš©ì ì •ë³´ íŒŒì‹± ì˜¤ë¥˜:', e);
                    alert('ì‚¬ìš©ì ì •ë³´ë¥¼ í™•ì¸í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                    return;
                }
            }
            
            const titleInput = document.getElementById('write-title');
            const authorInput = document.getElementById('write-author');
            const contentInput = document.getElementById('write-content');
            
            if (!titleInput || !authorInput || !contentInput) {
                console.error('ì…ë ¥ í•„ë“œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                alert('ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. í˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨í•´ì£¼ì„¸ìš”.');
                return;
            }
            
            const title = titleInput.value.trim();
            const author = authorInput.value.trim();
            const content = contentInput.value.trim();

            if (!title || !author || !content) {
                alert('ëª¨ë“  í•­ëª©ì„ ì…ë ¥í•˜ì„¸ìš”.');
                return;
            }

            // í˜„ì¬ ì‚¬ìš©ì ì •ë³´ ê°€ì ¸ì˜¤ê¸° (ì‘ì„±ì í™•ì¸ìš©)
            const loggedInUser = sessionStorage.getItem('loggedInUser');
            let uid = null;
            let username = null;
            let name = null;
            
            if (loggedInUser) {
                try {
                    const userData = JSON.parse(loggedInUser);
                    uid = userData.uid;
                    username = userData.username;
                    name = userData.name;
                } catch (e) {
                    console.error('ì‚¬ìš©ì ì •ë³´ íŒŒì‹± ì˜¤ë¥˜:', e);
                }
            }
            
            const newPost = {
                title: title,
                author: author,
                content: content,
                date: new Date().toLocaleDateString('ko-KR'),
                uid: uid,  // ì‘ì„±ì UID ì €ì¥
                username: username,  // ì‘ì„±ì username ì €ì¥
                name: name  // ì‘ì„±ì name ì €ì¥
            };

            if (!allPosts[currentBoard]) {
                allPosts[currentBoard] = [];
            }
            
            allPosts[currentBoard].unshift(newPost);
            savePosts(currentBoard).then(() => {
                currentPage[currentBoard] = 1;
                renderPosts();
                hideWriteForm();
                alert('ê²Œì‹œê¸€ì´ ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤.');
            });
        }

        function viewPost(index) {
            const post = allPosts[currentBoard][index];
            if (!post) return;

            currentPostIndex = index; // í˜„ì¬ ê²Œì‹œê¸€ ì¸ë±ìŠ¤ ì €ì¥
            document.getElementById('post-title').textContent = post.title;
            document.getElementById('post-meta').innerHTML = `
                <strong>ì‘ì„±ì:</strong> ${post.author} | <strong>ì‘ì„±ì¼:</strong> ${post.date}
            `;
            document.getElementById('post-content').textContent = post.content;
            
            // ì‚­ì œ ë²„íŠ¼ í‘œì‹œ ì—¬ë¶€ ê²°ì •
            const loggedInUser = sessionStorage.getItem('loggedInUser');
            const deleteBtn = document.getElementById('post-delete-btn');
            
            if (loggedInUser) {
                const userData = JSON.parse(loggedInUser);
                const isAdmin = userData.isAdmin || userData.username === 'admin';
                
                let canDelete = false;
                
                if (currentBoard === 'notice') {
                    // ê³µì§€ì‚¬í•­: ê´€ë¦¬ìë§Œ ì‚­ì œ ê°€ëŠ¥
                    canDelete = isAdmin;
                } else if (currentBoard === 'staff' || currentBoard === 'suggestion' || currentBoard === 'as-result') {
                    // ì§ì›ê²Œì‹œíŒ, ì œì•ˆí™œë™, A/S ì²˜ë¦¬ê²°ê³¼: ì‘ì„±ì ë˜ëŠ” ê´€ë¦¬ìë§Œ ì‚­ì œ ê°€ëŠ¥
                    const isAuthor = post.author === userData.name || 
                                    post.author === userData.username ||
                                    (post.uid && post.uid === userData.uid);
                    canDelete = isAdmin || isAuthor;
                } else {
                    // ê¸°íƒ€ ê²Œì‹œíŒ: ê¸°ë³¸ì ìœ¼ë¡œ ì‘ì„±ì ë˜ëŠ” ê´€ë¦¬ìë§Œ ì‚­ì œ ê°€ëŠ¥
                    const isAuthor = post.author === userData.name || 
                                    post.author === userData.username ||
                                    (post.uid && post.uid === userData.uid);
                    canDelete = isAdmin || isAuthor;
                }
                
                deleteBtn.style.display = canDelete ? 'block' : 'none';
            } else {
                deleteBtn.style.display = 'none';
            }
            
            document.getElementById('post-modal').style.display = 'block';
            document.getElementById('overlay').style.display = 'block';
        }

        function closePostModal() {
            document.getElementById('post-modal').style.display = 'none';
            document.getElementById('overlay').style.display = 'none';
            currentPostIndex = -1; // ì¸ë±ìŠ¤ ì´ˆê¸°í™”
            document.getElementById('post-delete-btn').style.display = 'none';
        }
        
        // ëª¨ë‹¬ì—ì„œ ì‚­ì œ ë²„íŠ¼ í´ë¦­ ì‹œ í˜¸ì¶œë˜ëŠ” í•¨ìˆ˜
        function deletePostFromModal() {
            if (currentPostIndex === -1) return;
            deletePost(currentPostIndex);
            closePostModal();
        }

        function searchPosts() {
            const searchType = document.getElementById('search-type').value;
            const searchQuery = document.getElementById('search-input').value.trim().toLowerCase();
            
            if (!searchQuery) {
                renderPosts();
                return;
            }

            const filtered = allPosts[currentBoard].filter(post => {
                if (searchType === 'title') {
                    return post.title.toLowerCase().includes(searchQuery);
                } else {
                    return post.content.toLowerCase().includes(searchQuery);
                }
            });

            // ê²€ìƒ‰ ê²°ê³¼ë¥¼ ì„ì‹œë¡œ ì €ì¥í•˜ê³  ë Œë”ë§
            const originalPosts = [...allPosts[currentBoard]];
            allPosts[currentBoard] = filtered;
            currentPage[currentBoard] = 1;
            renderPosts();
            
            // ì›ë³¸ ë³µì› (ë‹¤ìŒ ê²€ìƒ‰ì„ ìœ„í•´)
            setTimeout(() => {
                allPosts[currentBoard] = originalPosts;
            }, 0);
        }

        // ì˜¤ë²„ë ˆì´ í´ë¦­ ì´ë²¤íŠ¸ (auth.jsì—ì„œ ë¡œê·¸ì¸ ê´€ë ¨ ì²˜ë¦¬)
        document.getElementById('overlay').addEventListener('click', function() {
            if (typeof hideLogin === 'function') hideLogin();
            hideWriteForm();
            closePostModal();
        });

        // ëª¨ë°”ì¼ ë©”ë‰´
        document.addEventListener('DOMContentLoaded', function () {
            const burger = document.getElementById('hamburger');
            const drawer = document.getElementById('mobile-nav');
            const overlay = document.getElementById('overlay');
            if (!burger || !drawer || !overlay) return;

            let prevFocus = null;
            function setState(open) {
                burger.setAttribute('aria-expanded', String(open));
                burger.setAttribute('aria-label', open ? 'ë©”ë‰´ ë‹«ê¸°' : 'ë©”ë‰´ ì—´ê¸°');
                drawer.classList.toggle('open', open);
                document.body.classList.toggle('menu-open', open);
                overlay.classList.toggle('menu-open', open);
            }
            function openMenu() {
                const login = document.getElementById('login-container');
                if (login && login.style.display === 'block') hideLogin();
                prevFocus = document.activeElement;
                setState(true);
                const first = drawer.querySelector('a');
                if (first) first.focus();
            }
            function closeMenu() {
                setState(false);
                if (prevFocus && prevFocus.focus) prevFocus.focus();
                prevFocus = null;
            }
            function toggleMenu() {
                const isOpen = drawer.classList.contains('open');
                isOpen ? closeMenu() : openMenu();
            }

            burger.addEventListener('click', function(e) {
                e.preventDefault();
                e.stopPropagation();
                toggleMenu();
            });
            overlay.addEventListener('click', () => { if (drawer.classList.contains('open')) closeMenu(); });
            drawer.querySelectorAll('a').forEach(a => a.addEventListener('click', closeMenu));
            document.addEventListener('keydown', (e) => { if (e.key === 'Escape' && drawer.classList.contains('open')) closeMenu(); });
            window.addEventListener('resize', () => { if (window.innerWidth > 1024 && drawer.classList.contains('open')) closeMenu(); });
  });
</script>

    <!-- ê²Œì‹œíŒ ì„¹ì…˜ -->
    <div class="board-section">
    <div class="board-header">
            <h2 id="board-title">ê³µì§€ì‚¬í•­</h2>
      </div>
    <div class="board-table">
      <div class="table-header">
        <span>ë²ˆí˜¸</span>
        <span>ê¸€ì œëª©</span>
        <span>ê¸€ì“´ì´</span>
        <span>ì‘ì„±ì¼</span>
    </div>
      <div id="board-tbody" class="table-body">
        <div class="table-empty">ê²Œì‹œê¸€ì´ ì—†ìŠµë‹ˆë‹¤.</div>
    </div>
    </div>
        <div id="pagination" style="display: flex; justify-content: center; margin-top: 15px; font-size: 20px;"></div>
    <div class="board-footer">
      <div class="search-group">
                <select id="search-type">
                    <option value="title">ì œëª©</option>
                    <option value="content">ë‚´ìš©</option>
        </select>
                <input type="text" id="search-input" placeholder="ê²€ìƒ‰ì–´ë¥¼ ì…ë ¥í•˜ì„¸ìš”" onkeypress="if(event.key==='Enter') searchPosts();" />
                <button onclick="searchPosts()">ê²€ìƒ‰</button>
      </div>
      <div class="action-buttons">
                <button class="write" onclick="showWriteForm()">ê¸€ì“°ê¸°</button>
      </div>
    </div>
</div>

    <!-- ê¸€ì“°ê¸° í¼ -->
    <div id="write-form" class="write-form">
        <h2>ê²Œì‹œê¸€ ì‘ì„±</h2>
        <input type="text" id="write-title" placeholder="ì œëª©">
        <input type="text" id="write-author" placeholder="ì‘ì„±ì">
        <textarea id="write-content" placeholder="ë‚´ìš©"></textarea>
        <div style="text-align: right;">
            <button class="cancel-btn" onclick="hideWriteForm()">ì·¨ì†Œ</button>
            <button onclick="submitPost()">ë“±ë¡</button>
        </div>
    </div>

    <!-- ê²Œì‹œê¸€ ë³´ê¸° ëª¨ë‹¬ -->
    <div id="post-modal" class="post-modal">
        <button class="close-btn" onclick="closePostModal()">&times;</button>
        <h3 id="post-title"></h3>
        <div id="post-meta" class="post-meta"></div>
        <div id="post-content" class="post-content"></div>
        <div class="post-modal-actions">
            <button id="post-delete-btn" class="post-delete-btn" onclick="deletePostFromModal()" style="display: none;">ğŸ—‘ï¸ ì‚­ì œ</button>
        </div>
    </div>

    <!-- íšŒì›ê´€ë¦¬ ì„¹ì…˜ -->
    <div class="board-section" id="member-section" style="display: none;">
        <div class="board-header">
            <h2>ğŸ‘¥ íšŒì›ê´€ë¦¬</h2>
        </div>
        
        <!-- íƒ­ ë²„íŠ¼ -->
        <div style="display: flex; gap: 10px; margin-bottom: 20px;">
            <button class="member-tab active" onclick="showMemberTab('pending')" data-tab="pending">
                ìŠ¹ì¸ ëŒ€ê¸° <span id="pending-count" style="background: #ff6b6b; color: white; padding: 2px 8px; border-radius: 10px; font-size: 12px; margin-left: 5px;">0</span>
            </button>
            <button class="member-tab" onclick="showMemberTab('approved')" data-tab="approved">ìŠ¹ì¸ ì™„ë£Œ</button>
            <button class="member-tab" onclick="showMemberTab('rejected')" data-tab="rejected">ê±°ì ˆë¨</button>
        </div>
        
        <div class="board-table">
            <div class="table-header" style="grid-template-columns: 60px 100px 150px 150px 100px 100px 120px;">
                <span>ë²ˆí˜¸</span>
                <span>ì•„ì´ë””</span>
                <span>ì´ë¦„</span>
                <span>ì´ë©”ì¼</span>
                <span>ì—°ë½ì²˜</span>
                <span>ì‹ ì²­ì¼</span>
                <span>ê´€ë¦¬</span>
            </div>
            <div id="member-tbody" class="table-body">
                <div class="table-empty">íšŒì›ì´ ì—†ìŠµë‹ˆë‹¤.</div>
            </div>
        </div>
        <div id="member-pagination" style="display: flex; justify-content: center; margin-top: 15px; font-size: 20px;"></div>
    </div>

    <!-- í™œë™ì‚¬ì§„ì²© ì„¹ì…˜ -->
    <div class="board-section" id="photo-gallery-section" style="display: none;">
        <div class="board-header">
            <h2>ğŸ“· í™œë™ì‚¬ì§„ì²©</h2>
            <button class="inquiry-btn photo-upload-btn" onclick="openPhotoUpload()">ğŸ“¤ ì‚¬ì§„ ì—…ë¡œë“œ</button>
        </div>
        
        <!-- ì‚¬ì§„ ê·¸ë¦¬ë“œ -->
        <div class="photo-grid" id="photo-grid">
            <div class="photo-empty">
                <span>ğŸ“·</span>
                <p>ì•„ì§ ì—…ë¡œë“œëœ ì‚¬ì§„ì´ ì—†ìŠµë‹ˆë‹¤.</p>
            </div>
        </div>
    </div>

    <!-- ì‚¬ì§„ ì—…ë¡œë“œ ëª¨ë‹¬ -->
    <div id="photo-upload-modal" class="tool-modal" style="display: none;">
        <div class="tool-modal-content photo-upload-content">
            <div class="tool-modal-header">
                <h3>ğŸ“¤ ì‚¬ì§„ ì—…ë¡œë“œ</h3>
                <button class="tool-modal-close" onclick="closePhotoUpload()">&times;</button>
            </div>
            <div class="photo-upload-body">
                <div class="photo-upload-area" id="photo-upload-area" onclick="document.getElementById('photo-file-input').click()">
                    <input type="file" id="photo-file-input" accept="image/*" multiple style="display: none;" onchange="handlePhotoSelect(event)">
                    <div class="upload-icon">ğŸ“·</div>
                    <p>í´ë¦­í•˜ì—¬ ì‚¬ì§„ì„ ì„ íƒí•˜ê±°ë‚˜<br>ì—¬ê¸°ë¡œ ë“œë˜ê·¸í•˜ì„¸ìš”</p>
                    <span class="upload-hint">JPG, PNG, GIF (ìµœëŒ€ 10MB)</span>
                </div>
                <div class="photo-upload-notice">
                    <div class="notice-icon">â„¹ï¸</div>
                    <div class="notice-content">
                        <strong>ìë™ ì••ì¶• ì•ˆë‚´</strong>
                        <p>ì—…ë¡œë“œëœ ì‚¬ì§„ì€ ìë™ìœ¼ë¡œ ì••ì¶•ë©ë‹ˆë‹¤.<br>
                        â€¢ ìµœëŒ€ í•´ìƒë„: 1200 x 1200px<br>
                        â€¢ ìµœì¢… ì €ì¥ í¬ê¸°: 800KB ì´í•˜</p>
                    </div>
                </div>
                <div class="photo-preview-grid" id="photo-preview-grid"></div>
                <div class="photo-upload-actions">
                    <button onclick="uploadPhotos()" class="upload-submit-btn" id="upload-submit-btn" disabled>ì—…ë¡œë“œ</button>
                </div>
            </div>
        </div>
    </div>

    <!-- ì‚¬ì§„ ë·°ì–´ ëª¨ë‹¬ -->
    <div id="photo-viewer-modal" class="photo-viewer-modal" style="display: none;">
        <button class="photo-viewer-close" onclick="closePhotoViewer()">&times;</button>
        <button class="photo-viewer-nav photo-viewer-prev" onclick="prevPhoto()">â€¹</button>
        <div class="photo-viewer-content">
            <img id="photo-viewer-image" src="" alt="">
            <div class="photo-viewer-info">
                <span id="photo-viewer-date"></span>
                <span id="photo-viewer-author"></span>
                <button id="photo-delete-btn" class="photo-delete-btn" onclick="deletePhoto()" style="display: none;">ğŸ—‘ï¸ ì‚­ì œ</button>
            </div>
        </div>
        <button class="photo-viewer-nav photo-viewer-next" onclick="nextPhoto()">â€º</button>
    </div>

    <style>
        /* í™œë™ì‚¬ì§„ì²© ìŠ¤íƒ€ì¼ */
        .photo-upload-btn {
            font-size: 12px !important;
            padding: 10px 20px !important;
            border-radius: 10px !important;
            transition: all 0.3s ease;
            background: rgba(255, 255, 255, 0.9) !important;
            border: 2px solid #cccccc !important;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15) !important;
            color: #333 !important;
        }

        .photo-upload-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.25) !important;
            background: rgba(255, 255, 255, 1) !important;
            border-color: #999999 !important;
        }

        .photo-upload-btn:active {
            transform: scale(0.95);
            box-shadow: 0 1px 4px rgba(0, 0, 0, 0.2) !important;
        }

        .photo-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 4px;
            padding: 10px;
            background: #f8f9fa;
            border-radius: 12px;
            min-height: 300px;
        }

        .photo-item {
            aspect-ratio: 1;
            overflow: hidden;
            cursor: pointer;
            position: relative;
            border-radius: 4px;
        }

        .photo-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.3s ease;
        }

        .photo-item:hover img {
            transform: scale(1.05);
        }

        .photo-item .photo-overlay {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: linear-gradient(transparent, rgba(0,0,0,0.7));
            padding: 8px;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .photo-item:hover .photo-overlay {
            opacity: 1;
        }

        .photo-overlay span {
            color: white;
            font-size: 11px;
        }

        .photo-empty {
            grid-column: 1 / -1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 80px;
            color: #6c757d;
        }

        .photo-empty span {
            font-size: 100px;
            opacity: 0.3;
            margin-bottom: 20px;
        }

        .photo-empty p {
            font-size: 20px;
            font-weight: 500;
        }

        /* ì‚¬ì§„ ì—…ë¡œë“œ ëª¨ë‹¬ */
        .photo-upload-content {
            width: 90%;
            max-width: 600px;
        }

        .photo-upload-body {
            padding: 24px;
        }

        .photo-upload-area {
            border: 3px dashed #dee2e6;
            border-radius: 16px;
            padding: 50px 40px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            background: #f8f9fa;
        }

        .photo-upload-area:hover {
            border-color: #44aa6b;
            background: #f0fff4;
        }

        .photo-upload-area.dragover {
            border-color: #44aa6b;
            background: #e8f5e9;
        }

        .upload-icon {
            font-size: 72px;
            margin-bottom: 16px;
        }

        .photo-upload-area p {
            color: #495057;
            margin: 0 0 12px;
            font-size: 18px;
            font-weight: 500;
        }

        .upload-hint {
            color: #6c757d;
            font-size: 14px;
        }

        .photo-upload-notice {
            display: flex;
            align-items: flex-start;
            gap: 12px;
            margin-top: 16px;
            padding: 16px;
            background: #e3f2fd;
            border-left: 4px solid #2196f3;
            border-radius: 8px;
        }

        .notice-icon {
            font-size: 24px;
            flex-shrink: 0;
        }

        .notice-content {
            flex: 1;
        }

        .notice-content strong {
            display: block;
            color: #1976d2;
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 6px;
        }

        .notice-content p {
            margin: 0;
            color: #424242;
            font-size: 13px;
            line-height: 1.6;
        }

        .photo-preview-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 8px;
            margin-top: 16px;
            max-height: 200px;
            overflow-y: auto;
        }

        .photo-preview-item {
            aspect-ratio: 1;
            position: relative;
            border-radius: 8px;
            overflow: hidden;
        }

        .photo-preview-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .photo-preview-item .remove-btn {
            position: absolute;
            top: 4px;
            right: 4px;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            border: none;
            background: rgba(255, 0, 0, 0.8);
            color: white;
            font-size: 14px;
            cursor: pointer;
        }

        .photo-upload-actions {
            margin-top: 20px;
            text-align: center;
        }

        .upload-submit-btn {
            padding: 14px 48px;
            font-size: 16px;
            font-weight: 600;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            background: linear-gradient(135deg, #44aa6b 0%, #3a8f5a 100%);
            color: white;
            box-shadow: 0 4px 12px rgba(68, 170, 107, 0.3);
        }

        .upload-submit-btn:disabled {
            background: #e9ecef;
            color: #adb5bd;
            cursor: not-allowed;
            box-shadow: none;
        }

        .upload-submit-btn:not(:disabled):hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(68, 170, 107, 0.4);
        }

        /* ì‚¬ì§„ ë·°ì–´ ëª¨ë‹¬ */
        .photo-viewer-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            z-index: 3000;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .photo-viewer-content {
            max-width: 90%;
            max-height: 85%;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .photo-viewer-content img {
            max-width: 100%;
            max-height: calc(100vh - 150px);
            object-fit: contain;
            border-radius: 8px;
        }

        .photo-viewer-close {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(255, 255, 255, 0.1);
            border: none;
            color: white;
            font-size: 32px;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .photo-viewer-close:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: scale(1.1);
        }

        .photo-viewer-nav {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(255, 255, 255, 0.1);
            border: none;
            color: white;
            font-size: 48px;
            width: 60px;
            height: 80px;
            cursor: pointer;
            transition: all 0.2s ease;
            border-radius: 8px;
        }

        .photo-viewer-prev { left: 20px; }
        .photo-viewer-next { right: 20px; }

        .photo-viewer-nav:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .photo-viewer-info {
            margin-top: 16px;
            color: white;
            display: flex;
            gap: 20px;
            align-items: center;
            font-size: 14px;
        }

        .photo-delete-btn {
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a6f 100%);
            border: none;
            color: white;
            padding: 8px 16px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.2s ease;
        }

        .photo-delete-btn:hover {
            transform: scale(1.05);
        }

        @media (max-width: 768px) {
            .photo-grid {
                grid-template-columns: repeat(3, 1fr);
                gap: 2px;
            }

            .photo-preview-grid {
                grid-template-columns: repeat(3, 1fr);
            }

            .photo-viewer-nav {
                width: 40px;
                height: 60px;
                font-size: 32px;
            }

            .photo-viewer-prev { left: 10px; }
            .photo-viewer-next { right: 10px; }
        }
    </style>

    <script>
        // í™œë™ì‚¬ì§„ì²© ë³€ìˆ˜
        let allPhotos = [];
        let currentPhotoIndex = 0;
        let selectedPhotoFiles = [];

        // Firebase Storage ì°¸ì¡°
        let storage = null;
        if (typeof firebase !== 'undefined' && firebase.storage) {
            storage = firebase.storage();
        }

        // ì‚¬ì§„ ëª©ë¡ ë¡œë“œ
        async function loadPhotos() {
            if (!db) {
                initStaffDB();
            }
            if (!db) {
                console.warn('Firebase ë¯¸ì—°ê²°');
                return;
            }

            try {
                const snapshot = await db.collection('activityPhotos')
                    .orderBy('createdAt', 'desc')
                    .get();
                
                allPhotos = [];
                snapshot.forEach(doc => {
                    allPhotos.push({ id: doc.id, ...doc.data() });
                });

                renderPhotoGrid();
            } catch (error) {
                console.error('ì‚¬ì§„ ë¡œë“œ ì˜¤ë¥˜:', error);
            }
        }

        // ì‚¬ì§„ ê·¸ë¦¬ë“œ ë Œë”ë§
        function renderPhotoGrid() {
            const grid = document.getElementById('photo-grid');
            
            if (allPhotos.length === 0) {
                grid.innerHTML = `
                    <div class="photo-empty">
                        <span>ğŸ“·</span>
                        <p>ì•„ì§ ì—…ë¡œë“œëœ ì‚¬ì§„ì´ ì—†ìŠµë‹ˆë‹¤.</p>
                    </div>
                `;
                return;
            }

            grid.innerHTML = allPhotos.map((photo, index) => `
                <div class="photo-item" onclick="openPhotoViewer(${index})">
                    <img src="${photo.url}" alt="${photo.filename}" loading="lazy">
                    <div class="photo-overlay">
                        <span>${new Date(photo.createdAt).toLocaleDateString('ko-KR')}</span>
                    </div>
                </div>
            `).join('');
        }

        // ì‚¬ì§„ ì—…ë¡œë“œ ëª¨ë‹¬ ì—´ê¸°
        function openPhotoUpload() {
            const loggedInUser = sessionStorage.getItem('loggedInUser');
            if (!loggedInUser) {
                alert('ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.');
                return;
            }
            
            selectedPhotoFiles = [];
            document.getElementById('photo-preview-grid').innerHTML = '';
            document.getElementById('upload-submit-btn').disabled = true;
            document.getElementById('photo-upload-modal').style.display = 'flex';
        }

        function closePhotoUpload() {
            document.getElementById('photo-upload-modal').style.display = 'none';
            selectedPhotoFiles = [];
        }

        // ë“œë˜ê·¸ ì•¤ ë“œë¡­ ì„¤ì •
        document.addEventListener('DOMContentLoaded', function() {
            const uploadArea = document.getElementById('photo-upload-area');
            if (uploadArea) {
                uploadArea.addEventListener('dragover', (e) => {
                    e.preventDefault();
                    uploadArea.classList.add('dragover');
                });
                uploadArea.addEventListener('dragleave', () => {
                    uploadArea.classList.remove('dragover');
                });
                uploadArea.addEventListener('drop', (e) => {
                    e.preventDefault();
                    uploadArea.classList.remove('dragover');
                    handlePhotoSelect({ target: { files: e.dataTransfer.files } });
                });
            }
        });

        // ì‚¬ì§„ ì„ íƒ ì²˜ë¦¬
        function handlePhotoSelect(event) {
            const files = Array.from(event.target.files);
            const validFiles = files.filter(file => {
                if (!file.type.startsWith('image/')) {
                    alert(`${file.name}ì€(ëŠ”) ì´ë¯¸ì§€ íŒŒì¼ì´ ì•„ë‹™ë‹ˆë‹¤.`);
                    return false;
                }
                if (file.size > 10 * 1024 * 1024) {
                    alert(`${file.name}ì€(ëŠ”) 10MBë¥¼ ì´ˆê³¼í•©ë‹ˆë‹¤.`);
                    return false;
                }
                return true;
            });

            selectedPhotoFiles = [...selectedPhotoFiles, ...validFiles];
            renderPhotoPreview();
        }

        // ì‚¬ì§„ ë¯¸ë¦¬ë³´ê¸° ë Œë”ë§
        function renderPhotoPreview() {
            const previewGrid = document.getElementById('photo-preview-grid');
            previewGrid.innerHTML = '';

            selectedPhotoFiles.forEach((file, index) => {
                const reader = new FileReader();
                reader.onload = (e) => {
                    const div = document.createElement('div');
                    div.className = 'photo-preview-item';
                    div.innerHTML = `
                        <img src="${e.target.result}" alt="ë¯¸ë¦¬ë³´ê¸°">
                        <button class="remove-btn" onclick="removePreviewPhoto(${index})">Ã—</button>
                    `;
                    previewGrid.appendChild(div);
                };
                reader.readAsDataURL(file);
            });

            document.getElementById('upload-submit-btn').disabled = selectedPhotoFiles.length === 0;
        }

        // ë¯¸ë¦¬ë³´ê¸° ì‚¬ì§„ ì œê±°
        function removePreviewPhoto(index) {
            selectedPhotoFiles.splice(index, 1);
            renderPhotoPreview();
        }

        // ì‚¬ì§„ ì—…ë¡œë“œ
        async function uploadPhotos() {
            if (selectedPhotoFiles.length === 0) return;

            const loggedInUser = sessionStorage.getItem('loggedInUser');
            if (!loggedInUser) {
                alert('ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.');
                return;
            }

            // DB í™•ì¸
            if (!db) {
                initStaffDB();
            }
            if (!db) {
                alert('ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²°ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.\ní˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.');
                return;
            }

            // Storage ì¬ì´ˆê¸°í™”
            if (!storage && typeof firebase !== 'undefined' && firebase.storage) {
                storage = firebase.storage();
            }

            const userData = JSON.parse(loggedInUser);
            const uploadBtn = document.getElementById('upload-submit-btn');
            
            // ìë™ ì••ì¶• ì•ˆë‚´ ë©”ì‹œì§€ í‘œì‹œ (ì²« ì—…ë¡œë“œ ì‹œì—ë§Œ)
            const hasShownNotice = sessionStorage.getItem('photoUploadNoticeShown');
            if (!hasShownNotice) {
                const noticeMsg = 'ğŸ“¸ ì‚¬ì§„ ì—…ë¡œë“œ ì•ˆë‚´\n\n' +
                    'ì—…ë¡œë“œëœ ì‚¬ì§„ì€ ìë™ìœ¼ë¡œ ì••ì¶•ë©ë‹ˆë‹¤:\n' +
                    'â€¢ ìµœëŒ€ í•´ìƒë„: 1200 x 1200px\n' +
                    'â€¢ ìµœì¢… ì €ì¥ í¬ê¸°: 800KB ì´í•˜\n\n' +
                    'ì••ì¶•ì„ ì‹œì‘í•©ë‹ˆë‹¤.';
                alert(noticeMsg);
                sessionStorage.setItem('photoUploadNoticeShown', 'true');
            }
            
            uploadBtn.disabled = true;
            uploadBtn.textContent = 'ì—…ë¡œë“œ ì¤‘...';

            try {
                for (const file of selectedPhotoFiles) {
                    const timestamp = Date.now();
                    const filename = `${timestamp}_${file.name}`;
                    let uploaded = false;
                    
                    // Firebase Storageì— ì—…ë¡œë“œ ì‹œë„
                    if (storage) {
                        try {
                            console.log('Storage ì—…ë¡œë“œ ì‹œì‘:', filename);
                            console.log('ì‚¬ìš©ì ì •ë³´:', {
                                uid: userData.uid,
                                username: userData.username,
                                name: userData.name
                            });
                            
                            const storageRef = storage.ref(`activity-photos/${filename}`);
                            const uploadTask = await storageRef.put(file);
                            const downloadURL = await uploadTask.ref.getDownloadURL();
                            console.log('Storage ì—…ë¡œë“œ ì™„ë£Œ, URL:', downloadURL);

                            // Firestoreì— ë©”íƒ€ë°ì´í„° ì €ì¥
                            console.log('Firestore ì €ì¥ ì‹œë„...');
                            try {
                                await db.collection('activityPhotos').add({
                                    filename: filename,
                                    originalName: file.name,
                                    url: downloadURL,
                                    uploadedBy: userData.uid || userData.username,
                                    uploaderName: userData.name || userData.username,
                                    createdAt: new Date().toISOString()
                                });
                                console.log('Firestore ì €ì¥ ì„±ê³µ');
                                uploaded = true;
                            } catch (firestoreError) {
                                console.error('Firestore ì €ì¥ ì˜¤ë¥˜:', firestoreError);
                                throw firestoreError; // ìƒìœ„ catchë¡œ ì „ë‹¬
                            }
                        } catch (storageError) {
                            console.warn('Storage ì—…ë¡œë“œ ì‹¤íŒ¨, Base64ë¡œ ëŒ€ì²´:', storageError);
                            console.warn('Storage ì˜¤ë¥˜ ìƒì„¸:', storageError.code, storageError.message);
                            // Storage ì—…ë¡œë“œ ì‹¤íŒ¨ ì‹œ Base64ë¡œ ì €ì¥
                        }
                    }
                    
                    // Storage ì—…ë¡œë“œ ì‹¤íŒ¨í–ˆê±°ë‚˜ Storageê°€ ì—†ìœ¼ë©´ ì••ì¶•ëœ Base64ë¡œ ì €ì¥
                    if (!uploaded) {
                        console.log('ì••ì¶•ëœ Base64ë¡œ ì €ì¥');
                        const compressedBase64 = await compressImage(file, 800);
                        console.log('ì••ì¶• ì™„ë£Œ, í¬ê¸°:', Math.round(compressedBase64.length / 1024), 'KB');
                        
                        console.log('Firestore ì €ì¥ ì‹œë„...');
                        console.log('ì‚¬ìš©ì ì •ë³´:', {
                            uid: userData.uid,
                            username: userData.username,
                            name: userData.name
                        });
                        
                        try {
                            await db.collection('activityPhotos').add({
                                filename: filename,
                                originalName: file.name,
                                url: compressedBase64,
                                uploadedBy: userData.uid || userData.username,
                                uploaderName: userData.name || userData.username,
                                createdAt: new Date().toISOString()
                            });
                            console.log('Firestore ì €ì¥ ì„±ê³µ');
                        } catch (firestoreError) {
                            console.error('Firestore ì €ì¥ ì˜¤ë¥˜:', firestoreError);
                            throw firestoreError; // ìƒìœ„ catchë¡œ ì „ë‹¬
                        }
                    }
                }

                alert('ì‚¬ì§„ì´ ì—…ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤!');
                closePhotoUpload();
                loadPhotos();
            } catch (error) {
                console.error('ì—…ë¡œë“œ ì˜¤ë¥˜:', error);
                console.error('ì˜¤ë¥˜ ìƒì„¸:', error.code, error.message);
                
                let errorMessage = 'ì—…ë¡œë“œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.';
                
                if (error.code === 'permission-denied' || 
                    (error.message && error.message.includes('permission'))) {
                    errorMessage += '\n\nâŒ ê¶Œí•œì´ ì—†ìŠµë‹ˆë‹¤.';
                    errorMessage += '\n\nFirebase Consoleì—ì„œ ë‹¤ìŒ ê·œì¹™ì„ í™•ì¸í•´ì£¼ì„¸ìš”:';
                    errorMessage += '\n1. Firestore > ê·œì¹™: activityPhotos ì»¬ë ‰ì…˜ì— create ê¶Œí•œ';
                    errorMessage += '\n2. Storage > ê·œì¹™: activity-photos í´ë”ì— write ê¶Œí•œ';
                    errorMessage += '\n\në¡œê·¸ì¸ ìƒíƒœ: ' + (loggedInUser ? 'ë¡œê·¸ì¸ë¨' : 'ë¡œê·¸ì¸ ì•ˆë¨');
                } else if (error.message) {
                    errorMessage += '\n\n' + error.message;
                    if (error.code) {
                        errorMessage += '\nì˜¤ë¥˜ ì½”ë“œ: ' + error.code;
                    }
                }
                
                alert(errorMessage);
            } finally {
                uploadBtn.disabled = false;
                uploadBtn.textContent = 'ì—…ë¡œë“œ';
            }
        }

        function fileToBase64(file) {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                reader.onload = () => resolve(reader.result);
                reader.onerror = reject;
                reader.readAsDataURL(file);
            });
        }

        // ì´ë¯¸ì§€ ì••ì¶• í•¨ìˆ˜ (Firestore 1MB ì œí•œ ëŒ€ì‘)
        function compressImage(file, maxSizeKB = 800) {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                reader.onload = (e) => {
                    const img = new Image();
                    img.onload = () => {
                        const canvas = document.createElement('canvas');
                        let width = img.width;
                        let height = img.height;
                        
                        // ìµœëŒ€ í¬ê¸° ì œí•œ (ê°€ë¡œ/ì„¸ë¡œ 1200px)
                        const maxDimension = 1200;
                        if (width > maxDimension || height > maxDimension) {
                            if (width > height) {
                                height = Math.round(height * maxDimension / width);
                                width = maxDimension;
                            } else {
                                width = Math.round(width * maxDimension / height);
                                height = maxDimension;
                            }
                        }
                        
                        canvas.width = width;
                        canvas.height = height;
                        
                        const ctx = canvas.getContext('2d');
                        ctx.drawImage(img, 0, 0, width, height);
                        
                        // í’ˆì§ˆì„ ì¡°ì ˆí•˜ë©° ì••ì¶•
                        let quality = 0.8;
                        let result = canvas.toDataURL('image/jpeg', quality);
                        
                        // ëª©í‘œ í¬ê¸° ì´í•˜ê°€ ë  ë•Œê¹Œì§€ í’ˆì§ˆ ë‚®ì¶”ê¸°
                        while (result.length > maxSizeKB * 1024 && quality > 0.1) {
                            quality -= 0.1;
                            result = canvas.toDataURL('image/jpeg', quality);
                        }
                        
                        resolve(result);
                    };
                    img.onerror = reject;
                    img.src = e.target.result;
                };
                reader.onerror = reject;
                reader.readAsDataURL(file);
            });
        }

        // ì‚¬ì§„ ë·°ì–´ ì—´ê¸°
        function openPhotoViewer(index) {
            currentPhotoIndex = index;
            const photo = allPhotos[index];
            
            document.getElementById('photo-viewer-image').src = photo.url;
            document.getElementById('photo-viewer-date').textContent = new Date(photo.createdAt).toLocaleDateString('ko-KR');
            document.getElementById('photo-viewer-author').textContent = `ì—…ë¡œë”: ${photo.uploaderName}`;
            
            // ê´€ë¦¬ìë§Œ ì‚­ì œ ë²„íŠ¼ í‘œì‹œ
            const loggedInUser = sessionStorage.getItem('loggedInUser');
            const deleteBtn = document.getElementById('photo-delete-btn');
            if (loggedInUser) {
                const userData = JSON.parse(loggedInUser);
                deleteBtn.style.display = userData.isAdmin ? 'block' : 'none';
            }
            
            document.getElementById('photo-viewer-modal').style.display = 'flex';
        }

        function closePhotoViewer() {
            document.getElementById('photo-viewer-modal').style.display = 'none';
        }

        function prevPhoto() {
            if (currentPhotoIndex > 0) {
                openPhotoViewer(currentPhotoIndex - 1);
            }
        }

        function nextPhoto() {
            if (currentPhotoIndex < allPhotos.length - 1) {
                openPhotoViewer(currentPhotoIndex + 1);
            }
        }

        // ì‚¬ì§„ ì‚­ì œ (ê´€ë¦¬ì ì „ìš©)
        async function deletePhoto() {
            if (!confirm('ì´ ì‚¬ì§„ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) return;

            const photo = allPhotos[currentPhotoIndex];
            
            try {
                // Firestoreì—ì„œ ì‚­ì œ
                await db.collection('activityPhotos').doc(photo.id).delete();
                
                // Storageì—ì„œ ì‚­ì œ ì‹œë„
                if (storage && photo.url.includes('firebase')) {
                    try {
                        const storageRef = storage.refFromURL(photo.url);
                        await storageRef.delete();
                    } catch (e) {
                        console.warn('Storage ì‚­ì œ ì‹¤íŒ¨:', e);
                    }
                }

                alert('ì‚¬ì§„ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.');
                closePhotoViewer();
                loadPhotos();
            } catch (error) {
                console.error('ì‚­ì œ ì˜¤ë¥˜:', error);
                alert('ì‚­ì œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
            }
        }

        // í‚¤ë³´ë“œ ì´ë²¤íŠ¸
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('photo-viewer-modal').style.display === 'flex') {
                if (e.key === 'Escape') closePhotoViewer();
                else if (e.key === 'ArrowLeft') prevPhoto();
                else if (e.key === 'ArrowRight') nextPhoto();
            }
        });

        // ëª¨ë‹¬ ì™¸ë¶€ í´ë¦­
        document.getElementById('photo-upload-modal')?.addEventListener('click', function(e) {
            if (e.target === this) closePhotoUpload();
        });
        document.getElementById('photo-viewer-modal')?.addEventListener('click', function(e) {
            if (e.target === this) closePhotoViewer();
        });
    </script>

    <style>
        .member-tab {
            padding: 10px 20px;
            border: 2px solid #e9ecef;
            background: #fff;
            border-radius: 10px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            color: #495057;
            transition: all 0.3s ease;
        }
        .member-tab:hover {
            border-color: #44aa6b;
            color: #44aa6b;
        }
        .member-tab.active {
            background: linear-gradient(135deg, #44aa6b 0%, #3a8f5a 100%);
            color: white;
            border-color: transparent;
        }
        .approve-btn {
            background: linear-gradient(135deg, #44aa6b 0%, #3a8f5a 100%) !important;
            color: white !important;
            border: none !important;
            padding: 6px 12px !important;
            border-radius: 6px !important;
            cursor: pointer;
            font-size: 12px !important;
            font-weight: 600;
            margin-right: 5px;
            transition: all 0.2s ease;
        }
        .approve-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 2px 8px rgba(68, 170, 107, 0.4);
        }
        .reject-btn {
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a6f 100%) !important;
            color: white !important;
            border: none !important;
            padding: 6px 12px !important;
            border-radius: 6px !important;
            cursor: pointer;
            font-size: 12px !important;
            font-weight: 600;
            transition: all 0.2s ease;
        }
        .reject-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 2px 8px rgba(255, 107, 107, 0.4);
        }
        .status-badge {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 600;
        }
        .status-pending { background: #fff3cd; color: #856404; }
        .status-approved { background: #d4edda; color: #155724; }
        .status-rejected { background: #f8d7da; color: #721c24; }
    </style>

    <script>
        // íšŒì› ê´€ë¦¬ ë³€ìˆ˜
        let allMembers = [];
        let currentMemberTab = 'pending';
        let memberCurrentPage = 1;
        const membersPerPage = 10;

        // íšŒì› ëª©ë¡ ë¡œë“œ
        async function loadMembers() {
            if (!db) {
                initStaffDB();
            }
            if (!db) {
                console.warn('Firebase ë¯¸ì—°ê²°');
                return;
            }
            try {
                const snapshot = await db.collection('users').get();
                allMembers = [];
                snapshot.forEach(doc => {
                    if (doc.id !== 'admin') {
                        allMembers.push({ id: doc.id, ...doc.data() });
                    }
                });
                // ìµœì‹ ìˆœ ì •ë ¬
                allMembers.sort((a, b) => new Date(b.createdAt || 0) - new Date(a.createdAt || 0));
                updatePendingCount();
                renderMembers();
            } catch (error) {
                console.error('íšŒì› ë¡œë“œ ì˜¤ë¥˜:', error);
            }
        }

        // ëŒ€ê¸° ì¤‘ íšŒì› ìˆ˜ ì—…ë°ì´íŠ¸
        function updatePendingCount() {
            const pendingCount = allMembers.filter(m => m.status === 'pending').length;
            const countEl = document.getElementById('pending-count');
            if (countEl) {
                countEl.textContent = pendingCount;
                countEl.style.display = pendingCount > 0 ? 'inline' : 'none';
            }
        }

        // íšŒì› íƒ­ ì „í™˜
        function showMemberTab(tab) {
            currentMemberTab = tab;
            memberCurrentPage = 1;
            document.querySelectorAll('.member-tab').forEach(t => {
                t.classList.toggle('active', t.dataset.tab === tab);
            });
            renderMembers();
        }

        // íšŒì› ëª©ë¡ ë Œë”ë§
        function renderMembers() {
            const tbody = document.getElementById('member-tbody');
            if (!tbody) return;

            const filteredMembers = allMembers.filter(m => m.status === currentMemberTab);
            
            if (filteredMembers.length === 0) {
                const messages = {
                    'pending': 'ìŠ¹ì¸ ëŒ€ê¸° ì¤‘ì¸ íšŒì›ì´ ì—†ìŠµë‹ˆë‹¤.',
                    'approved': 'ìŠ¹ì¸ëœ íšŒì›ì´ ì—†ìŠµë‹ˆë‹¤.',
                    'rejected': 'ê±°ì ˆëœ íšŒì›ì´ ì—†ìŠµë‹ˆë‹¤.'
                };
                tbody.innerHTML = `<div class="table-empty">${messages[currentMemberTab]}</div>`;
                document.getElementById('member-pagination').innerHTML = '';
                return;
            }

            const start = (memberCurrentPage - 1) * membersPerPage;
            const end = start + membersPerPage;
            const pageMembers = filteredMembers.slice(start, end);

            tbody.innerHTML = '';
            pageMembers.forEach((member, index) => {
                const row = document.createElement('div');
                row.className = 'table-row';
                row.style.gridTemplateColumns = '60px 100px 150px 150px 100px 100px 120px';
                
                const date = member.createdAt ? new Date(member.createdAt).toLocaleDateString('ko-KR') : '-';
                
                let actionButtons = '';
                if (currentMemberTab === 'pending') {
                    actionButtons = `
                        <button class="approve-btn" onclick="approveMember('${member.id}')">ìŠ¹ì¸</button>
                        <button class="reject-btn" onclick="rejectMember('${member.id}')">ê±°ì ˆ</button>
                    `;
                } else if (currentMemberTab === 'approved') {
                    actionButtons = `<button class="reject-btn" onclick="rejectMember('${member.id}')">íƒˆí‡´</button>`;
                } else {
                    actionButtons = `
                        <button class="approve-btn" onclick="approveMember('${member.id}')">ë³µêµ¬</button>
                        <button class="reject-btn" onclick="deleteMember('${member.id}')">ì‚­ì œ</button>
                    `;
                }

                row.innerHTML = `
                    <span>${start + index + 1}</span>
                    <span>${member.username || member.id}</span>
                    <span>${member.name || '-'}</span>
                    <span style="font-size: 11px;">${member.email || '-'}</span>
                    <span style="font-size: 11px;">${member.phone || '-'}</span>
                    <span style="font-size: 11px;">${date}</span>
                    <span>${actionButtons}</span>
                `;
                tbody.appendChild(row);
            });

            renderMemberPagination(filteredMembers.length);
        }

        // íšŒì› í˜ì´ì§€ë„¤ì´ì…˜
        function renderMemberPagination(total) {
            const pagination = document.getElementById('member-pagination');
            if (!pagination) return;
            pagination.innerHTML = '';
            
            const totalPages = Math.ceil(total / membersPerPage);
            if (totalPages <= 1) return;

            for (let i = 1; i <= totalPages; i++) {
                const dot = document.createElement('span');
                dot.textContent = 'â—';
                dot.className = 'pagination-dot' + (i === memberCurrentPage ? ' active' : '');
                dot.onclick = () => {
                    memberCurrentPage = i;
                    renderMembers();
                };
                pagination.appendChild(dot);
            }
        }

        // íšŒì› ìŠ¹ì¸
        async function approveMember(userId) {
            if (!confirm('ì´ íšŒì›ì„ ìŠ¹ì¸í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) return;
            try {
                await db.collection('users').doc(userId).update({ status: 'approved' });
                const member = allMembers.find(m => m.id === userId);
                if (member) member.status = 'approved';
                updatePendingCount();
                renderMembers();
                alert('íšŒì›ì´ ìŠ¹ì¸ë˜ì—ˆìŠµë‹ˆë‹¤.');
            } catch (error) {
                console.error('ìŠ¹ì¸ ì˜¤ë¥˜:', error);
                alert('ìŠ¹ì¸ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
            }
        }

        // íšŒì› ê±°ì ˆ
        async function rejectMember(userId) {
            if (!confirm('ì´ íšŒì›ì„ ê±°ì ˆ/íƒˆí‡´ ì²˜ë¦¬í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) return;
            try {
                await db.collection('users').doc(userId).update({ status: 'rejected' });
                const member = allMembers.find(m => m.id === userId);
                if (member) member.status = 'rejected';
                updatePendingCount();
                renderMembers();
                alert('ì²˜ë¦¬ë˜ì—ˆìŠµë‹ˆë‹¤.');
            } catch (error) {
                console.error('ê±°ì ˆ ì˜¤ë¥˜:', error);
                alert('ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
            }
        }

        // íšŒì› ì‚­ì œ
        async function deleteMember(userId) {
            if (!confirm('ì´ íšŒì› ì •ë³´ë¥¼ ì™„ì „íˆ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?\nì´ ì‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.')) return;
            try {
                await db.collection('users').doc(userId).delete();
                allMembers = allMembers.filter(m => m.id !== userId);
                updatePendingCount();
                renderMembers();
                alert('íšŒì›ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.');
            } catch (error) {
                console.error('ì‚­ì œ ì˜¤ë¥˜:', error);
                alert('ì‚­ì œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
            }
        }
    </script>

    <div class="partner-logos">
            <a href="https://www.g2b.go.kr/" target="_blank">
                <img src="../image/logo1.png" alt="íŒŒíŠ¸ë„ˆ 1">
            </a>
            <a href="https://shop.g2b.go.kr/" target="_blank">
                <img src="../image/logo2.png" alt="íŒŒíŠ¸ë„ˆ 2">
            </a>
            <a href="https://hometax.go.kr/" target="_blank">
                <img src="../image/logo3.png" alt="íŒŒíŠ¸ë„ˆ 3">
            </a>
            <a href="https://www.smpp.go.kr" target="_blank">
                <img src="../image/logo4.png" alt="íŒŒíŠ¸ë„ˆ 4">
            </a>
            <a href="https://ecosq.or.kr/" target="_blank">
                <img src="../image/logo5.png" alt="íŒŒíŠ¸ë„ˆ 5">
            </a>
            <a href="https://www.sgic.co.kr/" target="_blank">
                <img src="../image/logo6.png" alt="íŒŒíŠ¸ë„ˆ 6">
            </a>
            <a href="https://si4n.nhis.or.kr/" target="_blank">
                <img src="../image/logo7.png" alt="íŒŒíŠ¸ë„ˆ 7">
            </a>
            <a href="https://www.4insure.or.kr/" target="_blank">
                <img src="../image/logo8.png" alt="íŒŒíŠ¸ë„ˆ 8">
            </a>
    </div>

    <!-- ê³„ì‚°ê¸° ëª¨ë‹¬ -->
    <div id="calculator-modal" class="tool-modal" style="display: none;">
        <div class="tool-modal-content calculator-content">
            <div class="tool-modal-header">
                <h3>ğŸ§® ê³„ì‚°ê¸°</h3>
                <button class="tool-modal-close" onclick="closeCalculator()">&times;</button>
            </div>
            <div class="calculator">
                <input type="text" id="calc-display" class="calc-display" readonly>
                <div class="calc-buttons">
                    <button onclick="clearCalc()" class="calc-btn calc-clear">C</button>
                    <button onclick="backspace()" class="calc-btn calc-clear">âŒ«</button>
                    <button onclick="appendCalc('%')" class="calc-btn calc-operator">%</button>
                    <button onclick="appendCalc('/')" class="calc-btn calc-operator">Ã·</button>
                    
                    <button onclick="appendCalc('7')" class="calc-btn">7</button>
                    <button onclick="appendCalc('8')" class="calc-btn">8</button>
                    <button onclick="appendCalc('9')" class="calc-btn">9</button>
                    <button onclick="appendCalc('*')" class="calc-btn calc-operator">Ã—</button>
                    
                    <button onclick="appendCalc('4')" class="calc-btn">4</button>
                    <button onclick="appendCalc('5')" class="calc-btn">5</button>
                    <button onclick="appendCalc('6')" class="calc-btn">6</button>
                    <button onclick="appendCalc('-')" class="calc-btn calc-operator">âˆ’</button>
                    
                    <button onclick="appendCalc('1')" class="calc-btn">1</button>
                    <button onclick="appendCalc('2')" class="calc-btn">2</button>
                    <button onclick="appendCalc('3')" class="calc-btn">3</button>
                    <button onclick="appendCalc('+')" class="calc-btn calc-operator">+</button>
                    
                    <button onclick="appendCalc('0')" class="calc-btn calc-zero">0</button>
                    <button onclick="appendCalc('.')" class="calc-btn">.</button>
                    <button onclick="calculate()" class="calc-btn calc-equals">=</button>
                </div>
            </div>
        </div>
    </div>

    <!-- ê·¸ë¦¼íŒ ëª¨ë‹¬ -->
    <div id="drawing-modal" class="tool-modal" style="display: none;">
        <div class="tool-modal-content drawing-content">
            <div class="tool-modal-header">
                <h3>ğŸ¨ ê·¸ë¦¼íŒ</h3>
                <button class="tool-modal-close" onclick="closeDrawingBoard()">&times;</button>
            </div>
            <div class="drawing-toolbar">
                <div class="tool-group">
                    <label>ìƒ‰ìƒ:</label>
                    <input type="color" id="draw-color" value="#000000">
                </div>
                <div class="tool-group">
                    <label>êµµê¸°:</label>
                    <input type="range" id="draw-size" min="1" max="50" value="5">
                    <span id="size-display">5px</span>
                </div>
                <div class="tool-group">
                    <button onclick="setDrawTool('pen')" class="draw-tool-btn active" id="pen-btn">âœï¸ íœ</button>
                    <button onclick="setDrawTool('eraser')" class="draw-tool-btn" id="eraser-btn">ğŸ§½ ì§€ìš°ê°œ</button>
                </div>
                <div class="tool-group">
                    <button onclick="clearCanvas()" class="draw-action-btn">ğŸ—‘ï¸ ì „ì²´ì§€ìš°ê¸°</button>
                    <button onclick="downloadCanvas()" class="draw-action-btn">ğŸ’¾ ì €ì¥</button>
                </div>
            </div>
            <canvas id="drawing-canvas" width="800" height="500"></canvas>
        </div>
    </div>

    <style>
        /* ë„êµ¬ ëª¨ë‹¬ ê³µí†µ ìŠ¤íƒ€ì¼ */
        .tool-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(4px);
            z-index: 2000;
            display: flex;
            justify-content: center;
            align-items: center;
            animation: fadeIn 0.2s ease;
        }

        .tool-modal-content {
            background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%);
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            overflow: hidden;
            animation: slideUp 0.3s ease;
        }

        @keyframes slideUp {
            from { transform: translateY(20px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .tool-modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 16px 24px;
            background: linear-gradient(135deg, #44aa6b 0%, #3a8f5a 100%);
            color: white;
        }

        .tool-modal-header h3 {
            margin: 0;
            font-size: 18px;
        }

        .tool-modal-close {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            font-size: 24px;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .tool-modal-close:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: scale(1.1);
        }

        /* ê³„ì‚°ê¸° ìŠ¤íƒ€ì¼ */
        .calculator-content {
            width: 320px;
        }

        .calculator {
            padding: 20px;
        }

        .calc-display {
            width: 100%;
            padding: 16px;
            font-size: 28px;
            text-align: right;
            border: none;
            background: #1a1a2e;
            color: #00ff88;
            border-radius: 12px;
            margin-bottom: 16px;
            box-sizing: border-box;
            font-family: 'Courier New', monospace;
        }

        .calc-buttons {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
        }

        .calc-btn {
            padding: 18px;
            font-size: 20px;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.2s ease;
            background: #e9ecef;
            color: #333;
            font-weight: 600;
        }

        .calc-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }

        .calc-btn:active {
            transform: translateY(0);
        }

        .calc-operator {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .calc-clear {
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a6f 100%);
            color: white;
        }

        .calc-equals {
            background: linear-gradient(135deg, #44aa6b 0%, #3a8f5a 100%);
            color: white;
        }

        .calc-zero {
            grid-column: span 2;
        }

        /* ê·¸ë¦¼íŒ ìŠ¤íƒ€ì¼ */
        .drawing-content {
            width: 90%;
            max-width: 900px;
            max-height: 90vh;
            overflow: hidden;
        }

        .drawing-toolbar {
            display: flex;
            flex-wrap: wrap;
            gap: 16px;
            padding: 16px 24px;
            background: #f8f9fa;
            border-bottom: 1px solid #e9ecef;
            align-items: center;
        }

        .tool-group {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .tool-group label {
            font-size: 14px;
            font-weight: 600;
            color: #495057;
        }

        #draw-color {
            width: 40px;
            height: 40px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
        }

        #draw-size {
            width: 100px;
        }

        #size-display {
            font-size: 12px;
            color: #6c757d;
            min-width: 35px;
        }

        .draw-tool-btn, .draw-action-btn {
            padding: 8px 16px;
            border: 2px solid #e9ecef;
            background: white;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.2s ease;
        }

        .draw-tool-btn:hover, .draw-action-btn:hover {
            border-color: #44aa6b;
            color: #44aa6b;
        }

        .draw-tool-btn.active {
            background: linear-gradient(135deg, #44aa6b 0%, #3a8f5a 100%);
            color: white;
            border-color: transparent;
        }

        .draw-action-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-color: transparent;
        }

        #drawing-canvas {
            display: block;
            background: white;
            cursor: crosshair;
            width: 100%;
            height: auto;
        }

        @media (max-width: 768px) {
            .calculator-content {
                width: 90%;
                max-width: 320px;
            }

            .drawing-content {
                width: 95%;
            }

            .drawing-toolbar {
                padding: 12px;
                gap: 10px;
            }

            .tool-group {
                flex-wrap: wrap;
            }
        }
    </style>

    <script>
        // ê³„ì‚°ê¸° ê¸°ëŠ¥
        let calcDisplay = '';

        function openCalculator() {
            document.getElementById('calculator-modal').style.display = 'flex';
            calcDisplay = '';
            document.getElementById('calc-display').value = '0';
        }

        function closeCalculator() {
            document.getElementById('calculator-modal').style.display = 'none';
        }

        function appendCalc(value) {
            if (calcDisplay === '0' && value !== '.') {
                calcDisplay = value;
            } else {
                calcDisplay += value;
            }
            document.getElementById('calc-display').value = calcDisplay;
        }

        function clearCalc() {
            calcDisplay = '';
            document.getElementById('calc-display').value = '0';
        }

        function backspace() {
            calcDisplay = calcDisplay.slice(0, -1);
            document.getElementById('calc-display').value = calcDisplay || '0';
        }

        function calculate() {
            try {
                let expression = calcDisplay.replace(/%/g, '/100');
                let result = eval(expression);
                if (!isFinite(result)) {
                    document.getElementById('calc-display').value = 'Error';
                    calcDisplay = '';
                } else {
                    result = Math.round(result * 1000000000) / 1000000000;
                    document.getElementById('calc-display').value = result;
                    calcDisplay = result.toString();
                }
            } catch (e) {
                document.getElementById('calc-display').value = 'Error';
                calcDisplay = '';
            }
        }

        // í‚¤ë³´ë“œ ì…ë ¥ ì§€ì›
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('calculator-modal').style.display === 'flex') {
                if (e.key >= '0' && e.key <= '9') appendCalc(e.key);
                else if (e.key === '+' || e.key === '-' || e.key === '*' || e.key === '/') appendCalc(e.key);
                else if (e.key === '.') appendCalc('.');
                else if (e.key === 'Enter' || e.key === '=') calculate();
                else if (e.key === 'Escape') closeCalculator();
                else if (e.key === 'Backspace') backspace();
                else if (e.key === 'c' || e.key === 'C') clearCalc();
            }
        });

        // ê·¸ë¦¼íŒ ê¸°ëŠ¥
        let canvas, ctx;
        let isDrawing = false;
        let currentTool = 'pen';
        let lastX = 0;
        let lastY = 0;

        function openDrawingBoard() {
            document.getElementById('drawing-modal').style.display = 'flex';
            initCanvas();
        }

        function closeDrawingBoard() {
            document.getElementById('drawing-modal').style.display = 'none';
        }

        function initCanvas() {
            canvas = document.getElementById('drawing-canvas');
            ctx = canvas.getContext('2d');
            
            // ìº”ë²„ìŠ¤ í¬ê¸° ì¡°ì • (ê³ ì • í¬ê¸°ë¡œ ì„¤ì •í•˜ì—¬ ì¢Œí‘œ ì •í™•ë„ í–¥ìƒ)
            const container = canvas.parentElement;
            const rect = container.getBoundingClientRect();
            const maxWidth = Math.min(800, rect.width - 48);
            
            // ìº”ë²„ìŠ¤ ì‹¤ì œ í”½ì…€ í¬ê¸° ì„¤ì •
            canvas.width = maxWidth;
            canvas.height = 500;
            
            // CSSë¡œ í‘œì‹œ í¬ê¸° ì„¤ì • (ì‹¤ì œ í¬ê¸°ì™€ ë™ì¼í•˜ê²Œ)
            canvas.style.width = maxWidth + 'px';
            canvas.style.height = '500px';
            
            // í°ìƒ‰ ë°°ê²½
            ctx.fillStyle = 'white';
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ (ì¤‘ë³µ ë°©ì§€)
            canvas.removeEventListener('mousedown', startDrawing);
            canvas.removeEventListener('mousemove', draw);
            canvas.removeEventListener('mouseup', stopDrawing);
            canvas.removeEventListener('mouseout', stopDrawing);
            canvas.removeEventListener('touchstart', handleTouchStart);
            canvas.removeEventListener('touchmove', handleTouchMove);
            canvas.removeEventListener('touchend', stopDrawing);
            
            canvas.addEventListener('mousedown', startDrawing);
            canvas.addEventListener('mousemove', draw);
            canvas.addEventListener('mouseup', stopDrawing);
            canvas.addEventListener('mouseout', stopDrawing);

            // í„°ì¹˜ ì§€ì›
            canvas.addEventListener('touchstart', handleTouchStart);
            canvas.addEventListener('touchmove', handleTouchMove);
            canvas.addEventListener('touchend', stopDrawing);

            // êµµê¸° í‘œì‹œ ì—…ë°ì´íŠ¸
            const sizeInput = document.getElementById('draw-size');
            if (sizeInput) {
                sizeInput.removeEventListener('input', updateSizeDisplay);
                sizeInput.addEventListener('input', updateSizeDisplay);
            }
        }
        
        function updateSizeDisplay() {
            document.getElementById('size-display').textContent = this.value + 'px';
        }

        // ìº”ë²„ìŠ¤ ì¢Œí‘œ ë³€í™˜ í•¨ìˆ˜ (í‘œì‹œ í¬ê¸°ì™€ ì‹¤ì œ í¬ê¸° ë¹„ìœ¨ ê³„ì‚°)
        function getCanvasCoordinates(e) {
            const rect = canvas.getBoundingClientRect();
            const scaleX = canvas.width / rect.width;
            const scaleY = canvas.height / rect.height;
            return {
                x: (e.clientX - rect.left) * scaleX,
                y: (e.clientY - rect.top) * scaleY
            };
        }

        function startDrawing(e) {
            isDrawing = true;
            const coords = getCanvasCoordinates(e);
            lastX = coords.x;
            lastY = coords.y;
        }

        function draw(e) {
            if (!isDrawing) return;

            const coords = getCanvasCoordinates(e);
            const x = coords.x;
            const y = coords.y;

            ctx.beginPath();
            ctx.moveTo(lastX, lastY);
            ctx.lineTo(x, y);
            
            if (currentTool === 'pen') {
                ctx.strokeStyle = document.getElementById('draw-color').value;
                ctx.globalCompositeOperation = 'source-over';
            } else {
                ctx.strokeStyle = 'white';
                ctx.globalCompositeOperation = 'source-over';
            }
            
            ctx.lineWidth = document.getElementById('draw-size').value;
            ctx.lineCap = 'round';
            ctx.lineJoin = 'round';
            ctx.stroke();

            lastX = x;
            lastY = y;
        }

        function stopDrawing() {
            isDrawing = false;
        }

        // í„°ì¹˜ ì¢Œí‘œ ë³€í™˜ í•¨ìˆ˜
        function getCanvasTouchCoordinates(touch) {
            const rect = canvas.getBoundingClientRect();
            const scaleX = canvas.width / rect.width;
            const scaleY = canvas.height / rect.height;
            return {
                x: (touch.clientX - rect.left) * scaleX,
                y: (touch.clientY - rect.top) * scaleY
            };
        }

        function handleTouchStart(e) {
            e.preventDefault();
            const touch = e.touches[0];
            const coords = getCanvasTouchCoordinates(touch);
            lastX = coords.x;
            lastY = coords.y;
            isDrawing = true;
        }

        function handleTouchMove(e) {
            e.preventDefault();
            if (!isDrawing) return;

            const touch = e.touches[0];
            const coords = getCanvasTouchCoordinates(touch);
            const x = coords.x;
            const y = coords.y;

            ctx.beginPath();
            ctx.moveTo(lastX, lastY);
            ctx.lineTo(x, y);
            
            if (currentTool === 'pen') {
                ctx.strokeStyle = document.getElementById('draw-color').value;
            } else {
                ctx.strokeStyle = 'white';
            }
            
            ctx.lineWidth = document.getElementById('draw-size').value;
            ctx.lineCap = 'round';
            ctx.lineJoin = 'round';
            ctx.stroke();

            lastX = x;
            lastY = y;
        }

        function setDrawTool(tool) {
            currentTool = tool;
            document.getElementById('pen-btn').classList.remove('active');
            document.getElementById('eraser-btn').classList.remove('active');
            document.getElementById(tool + '-btn').classList.add('active');
        }

        function clearCanvas() {
            if (confirm('ê·¸ë¦¼ì„ ëª¨ë‘ ì§€ìš°ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                ctx.fillStyle = 'white';
                ctx.fillRect(0, 0, canvas.width, canvas.height);
            }
        }

        function downloadCanvas() {
            const link = document.createElement('a');
            link.download = 'ê·¸ë¦¼_' + new Date().toISOString().slice(0, 10) + '.png';
            link.href = canvas.toDataURL('image/png');
            link.click();
        }

        // ëª¨ë‹¬ ì™¸ë¶€ í´ë¦­ ì‹œ ë‹«ê¸°
        document.getElementById('calculator-modal').addEventListener('click', function(e) {
            if (e.target === this) closeCalculator();
        });

        document.getElementById('drawing-modal').addEventListener('click', function(e) {
            if (e.target === this) closeDrawingBoard();
        });
    </script>

    <div style="padding: 15px 20px 5px 20px; font-size: 10px; color: #bcbcbc; text-align: left; line-height: 0.5;">
      <p style="text-indent: 20px;">1. ë³¸ í™ˆí˜ì´ì§€ëŠ” ë°ìŠ¤í¬íƒ‘ ë¸Œë¼ìš°ì € ë²„ì „ì— ìµœì í™” ë˜ì–´ìˆìŠµë‹ˆë‹¤. ì›í™œí•œ ì‚¬ìš©ì„ ìœ„í•´ ë°ìŠ¤í¬íƒ‘ ë¸Œë¼ìš°ì € í™˜ê²½ìœ¼ë¡œ ì‚¬ìš©í•´ì£¼ì„¸ìš”.<br></p>
      <p style="text-indent: 20px;">2. í•˜ë‚˜ë¡œì˜¤ì—ì´í¼ë‹ˆì²˜ëŠ” ì¡°ë‹¬ì²­ ë° ê³µê³µê¸°ê´€ ë‚©í’ˆ ì „ìš© ê°€êµ¬ë¥¼ ì „ë¬¸ìœ¼ë¡œ ì œì‘í•˜ëŠ” ê¸°ì—… ì…ë‹ˆë‹¤. ë³¸ í™ˆí˜ì´ì§€ì—ì„œ ì†Œê°œë˜ëŠ” ì œí’ˆë“¤ì€ ì¡°ë‹¬ì²­ ì¢…í•©ì‡¼í•‘ëª° íŒë§¤ ì „ìš©ì…ë‹ˆë‹¤.</p>
    </div>
        
    <footer>
        <p>Copyright Â© 2025 (ì£¼)í•˜ë‚˜ë¡œì˜¤ì—ì´í¼ë‹ˆì²˜. ëª¨ë“  ê¶Œë¦¬ ë³´ìœ . | ë¬¸ì˜ : oa9500@empas.com | ì „í™” : 042-633-9500  |  A/S : 043-731-9511</p>
        <p class="footer-info">ì£¼ì‹íšŒì‚¬ í•˜ë‚˜ë¡œì˜¤ì—ì´í¼ë‹ˆì²˜ | ëŒ€í‘œì´ì‚¬ : ì •ì§„í¬, ì¥ì¸ë• | ì£¼ì†Œ : ëŒ€ì „ê´‘ì—­ì‹œ ëŒ€ë•êµ¬ ì˜¤ì •ë¡œ 41ë²ˆê¸¸ 12 | ì „í™” : 042-633-9500 | ì‚¬ì—…ìë“±ë¡ë²ˆí˜¸ : 305-81-45158</p>
    </footer>
</body>
</html>
